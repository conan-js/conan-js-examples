{"ast":null,"code":"\"use strict\";\n\nvar _createForOfIteratorHelper = require(\"/Users/albertoalmansa/Projects/conan-js/tmp/conan-js-examples/composingState/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createForOfIteratorHelper\");\n\nvar _defineProperty = require(\"/Users/albertoalmansa/Projects/conan-js/tmp/conan-js-examples/composingState/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/defineProperty\");\n\nvar _slicedToArray = require(\"/Users/albertoalmansa/Projects/conan-js/tmp/conan-js-examples/composingState/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/slicedToArray\");\n\nvar _inherits = require(\"/Users/albertoalmansa/Projects/conan-js/tmp/conan-js-examples/composingState/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/inherits\");\n\nvar _createSuper = require(\"/Users/albertoalmansa/Projects/conan-js/tmp/conan-js-examples/composingState/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createSuper\");\n\nvar _construct = require(\"/Users/albertoalmansa/Projects/conan-js/tmp/conan-js-examples/composingState/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/construct\");\n\nvar _toConsumableArray = require(\"/Users/albertoalmansa/Projects/conan-js/tmp/conan-js-examples/composingState/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/toConsumableArray\");\n\nvar _classCallCheck = require(\"/Users/albertoalmansa/Projects/conan-js/tmp/conan-js-examples/composingState/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/Users/albertoalmansa/Projects/conan-js/tmp/conan-js-examples/composingState/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: !0\n});\n\nvar InjectableType,\n    React = require(\"react\");\n\nvar DynamicOrStatics = /*#__PURE__*/function () {\n  function DynamicOrStatics() {\n    _classCallCheck(this, DynamicOrStatics);\n  }\n\n  _createClass(DynamicOrStatics, null, [{\n    key: \"result\",\n    value: function result(t, e) {\n      return \"function\" == typeof t ? t(e) : t;\n    }\n  }]);\n\n  return DynamicOrStatics;\n}();\n\nvar Strings = /*#__PURE__*/function () {\n  function Strings() {\n    _classCallCheck(this, Strings);\n  }\n\n  _createClass(Strings, null, [{\n    key: \"firstCharToLowerCase\",\n    value: function firstCharToLowerCase(t) {\n      return t.substring(0, 1).toLowerCase() + t.substring(1, t.length);\n    }\n  }, {\n    key: \"firstCharToUpperCase\",\n    value: function firstCharToUpperCase(t) {\n      return t.substring(0, 1).toUpperCase() + t.substring(1, t.length);\n    }\n  }, {\n    key: \"camelCaseWithPrefix\",\n    value: function camelCaseWithPrefix(t, e) {\n      return t + this.firstCharToUpperCase(e);\n    }\n  }, {\n    key: \"repeat\",\n    value: function repeat(t, e) {\n      var a = \"\";\n\n      for (var n = 0; n < e; n++) {\n        a += t;\n      }\n\n      return a;\n    }\n  }, {\n    key: \"padEnd\",\n    value: function padEnd(t, e) {\n      if (null == t) return t;\n      var a = e - t.length;\n\n      if (a < 1) {\n        var _a = \"...\",\n            n = 1,\n            s = n + (t.length + _a.length - e);\n        return t.substring(0, n) + _a + t.substring(s, t.length);\n      }\n\n      return t + \" \".repeat(a);\n    }\n  }]);\n\n  return Strings;\n}();\n\nvar DiUtils = /*#__PURE__*/function () {\n  function DiUtils() {\n    _classCallCheck(this, DiUtils);\n  }\n\n  _createClass(DiUtils, null, [{\n    key: \"beanName\",\n    value: function beanName(t) {\n      return Strings.firstCharToLowerCase(t.name);\n    }\n  }]);\n\n  return DiUtils;\n}();\n\n!function (t) {\n  t.DYNAMIC = \"dynamic\", t.NAME = \"name\", t.TYPE = \"type\";\n}(InjectableType || (InjectableType = {}));\n\nvar MetadataCrudUtils = /*#__PURE__*/function () {\n  function MetadataCrudUtils(t, e) {\n    _classCallCheck(this, MetadataCrudUtils);\n\n    this.spaceName = t, this.defaultProvider = e;\n  }\n\n  _createClass(MetadataCrudUtils, [{\n    key: \"updateMetadata\",\n    value: function updateMetadata(t, e) {\n      var a = this.getOrCreateMetadata(t);\n      if (null == a) throw Error(\"can't get or create metaData\");\n      return e(a), a;\n    }\n  }, {\n    key: \"assignMetaDataToConstructor\",\n    value: function assignMetaDataToConstructor(t, e) {\n      var a = this.getPrototype(t);\n      null == a.$a && (a.$a = {}), null == a.$a[this.spaceName] && (a.$a[this.spaceName] = {});\n      var n = MetadataCrudUtils.extractName(t);\n      a.$a[this.spaceName][n] = e;\n    }\n  }, {\n    key: \"getAnnotationsMetaData\",\n    value: function getAnnotationsMetaData(t) {\n      var e = t;\n      e.$a || (e = this.getPrototype(t));\n      var a = e.$a;\n      if (null == a) return null;\n      var n = a[this.spaceName];\n      return null == n ? null : n[MetadataCrudUtils.extractName(t)];\n    }\n  }, {\n    key: \"getOrCreateMetadata\",\n    value: function getOrCreateMetadata(t) {\n      if (null == this.getAnnotationsMetaData(t)) {\n        var e = this.defaultProvider();\n        this.assignMetaDataToConstructor(t, e);\n      }\n\n      return this.getAnnotationsMetaData(t);\n    }\n  }, {\n    key: \"getPrototype\",\n    value: function getPrototype(t) {\n      return \"object\" == typeof t ? t : \"object\" == typeof t.prototype ? t.prototype : this.getPrototype(Object.getPrototypeOf(t));\n    }\n  }], [{\n    key: \"extractName\",\n    value: function extractName(t) {\n      var e = t.name;\n      return null == e && (e = t.constructor.name), e.substring(0, 1).toLowerCase() + e.substring(1, e.length);\n    }\n  }]);\n\n  return MetadataCrudUtils;\n}();\n\nvar diAnnotationsCrud = new MetadataCrudUtils(\"$di\", function () {\n  return {\n    diAnnotations: []\n  };\n});\n\nfunction InjectByType(t, e) {\n  return function (a, n, s) {\n    diAnnotationsCrud.updateMetadata(a, function (a) {\n      return a.diAnnotations.push({\n        onConstructorParamIndex: s,\n        injectable: t,\n        type: InjectableType.TYPE,\n        cascadeProperties: e\n      });\n    });\n  };\n}\n\nfunction InjectDynamic(t, e) {\n  return function (a, n, s) {\n    diAnnotationsCrud.updateMetadata(a, function (a) {\n      return a.diAnnotations.push({\n        onConstructorParamIndex: s,\n        injectable: t,\n        type: InjectableType.DYNAMIC,\n        cascadeProperties: e\n      });\n    });\n  };\n}\n\nfunction InjectByName(t, e) {\n  return console.log(\"Inject by name\", t), function (a, n, s) {\n    diAnnotationsCrud.updateMetadata(a, function (a) {\n      return a.diAnnotations.push({\n        onConstructorParamIndex: s,\n        injectable: t,\n        type: InjectableType.NAME,\n        cascadeProperties: e\n      });\n    });\n  };\n}\n\nvar STRIP_COMMENTS = /((\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/))/gm,\n    ARGUMENT_NAMES = /([^\\s,]+)/g;\n\nvar Functions = /*#__PURE__*/function () {\n  function Functions() {\n    _classCallCheck(this, Functions);\n  }\n\n  _createClass(Functions, null, [{\n    key: \"extractArgNames\",\n    value: function extractArgNames(t) {\n      if (0 === t.length) return [];\n      var e = t.toString().replace(STRIP_COMMENTS, \"\"),\n          a = e.slice(e.indexOf(\"(\") + 1, e.indexOf(\")\")).match(ARGUMENT_NAMES);\n      return null === a && (a = []), a;\n    }\n  }]);\n\n  return Functions;\n}();\n\nvar DiAnnotationsMetadataFactory = /*#__PURE__*/function () {\n  function DiAnnotationsMetadataFactory() {\n    _classCallCheck(this, DiAnnotationsMetadataFactory);\n  }\n\n  _createClass(DiAnnotationsMetadataFactory, [{\n    key: \"create\",\n    value: function create(t) {\n      var e = DiUtils.beanName(t),\n          a = Functions.extractArgNames(t),\n          n = {},\n          s = diAnnotationsCrud.getAnnotationsMetaData(t);\n      return s && s.diAnnotations.forEach(function (t) {\n        var e = a[t.onConstructorParamIndex];\n        n[e] = {\n          name: e,\n          type: t.type,\n          payload: t.injectable,\n          propsProvider: t.cascadeProperties\n        };\n      }), {\n        dependencyName: e,\n        argumentNames: a,\n        diParams: n,\n        constructor: t\n      };\n    }\n  }]);\n\n  return DiAnnotationsMetadataFactory;\n}();\n\nvar DiRuntime = /*#__PURE__*/function () {\n  function DiRuntime(t, e) {\n    _classCallCheck(this, DiRuntime);\n\n    this.diInvocationResolver = t, this.diInvocationBuilderFactory = e;\n  }\n\n  _createClass(DiRuntime, [{\n    key: \"invoke\",\n    value: function invoke(t, e, a) {\n      if (\"object\" == typeof t) return t;\n      var n = this.diInvocationBuilderFactory.root(t).if(null != e, function (t) {\n        return t.withTransitiveBeans(e);\n      }).build(),\n          s = this.diInvocationResolver.resolve(n, a, this).result;\n      if (null == s) throw Error(\"Can't invoke\");\n      return s;\n    }\n  }, {\n    key: \"invokeWithProps\",\n    value: function invokeWithProps(t, e, a, n) {\n      var s = this.diInvocationBuilderFactory.root(t).withProperties(e).if(null != a, function (t) {\n        return t.withTransitiveBeans(a);\n      }).build(),\n          r = this.diInvocationResolver.resolve(s, n, this).result;\n      if (null == r) throw Error(\"Can't invoke\");\n      return r;\n    }\n  }]);\n\n  return DiRuntime;\n}();\n\nDiRuntime.PROPS_PROPERTY_NAME = \"$props\";\n\nvar DiInvocationResolver = /*#__PURE__*/function () {\n  function DiInvocationResolver(t, e, a) {\n    _classCallCheck(this, DiInvocationResolver);\n\n    this.diInvocationFactory = t, this.diCache = e, this.diEnricher = a;\n  }\n\n  _createClass(DiInvocationResolver, [{\n    key: \"resolve\",\n    value: function resolve(t, e, a) {\n      var _this = this;\n\n      if (this.causesCircularDependency(t)) return {\n        circularDependencyEndOf: t.diMetadata.dependencyName,\n        result: null,\n        pendingDependencies: {}\n      };\n      var n = null,\n          s = this.diCache.resolve(t.diMetadata.dependencyName, function () {\n        return n = _this.doCreate(t, e, a), _this.diEnricher && (n.result = _this.diEnricher(t.diMetadata, n.result)), Object.keys(n.pendingDependencies).indexOf(t.diMetadata.dependencyName) > -1 && n.pendingDependencies[t.diMetadata.dependencyName].forEach(function (e) {\n          _this.diCache.resolve(e, null)[t.diMetadata.dependencyName] = n.result;\n        }), n.result;\n      });\n      return null == n ? {\n        result: s,\n        pendingDependencies: {}\n      } : n;\n    }\n  }, {\n    key: \"causesCircularDependency\",\n    value: function causesCircularDependency(t) {\n      return t.inProcessDiInvocations.indexOf(t.diMetadata.dependencyName) > -1;\n    }\n  }, {\n    key: \"doCreate\",\n    value: function doCreate(t, e, a) {\n      var n = function n(t, e) {\n        var a = t.diMetadata.constructor;\n        return a.prototype && a.prototype.constructor.name ? e ? _construct(a, _toConsumableArray(e)) : new a() : e ? a.apply(void 0, _toConsumableArray(e)) : a();\n      };\n\n      if (0 === t.diMetadata.argumentNames.length) {\n        return {\n          result: n(t, void 0),\n          pendingDependencies: {}\n        };\n      }\n\n      var s = [],\n          r = {};\n      return this.invokeChildren(t, e, a).forEach(function (e) {\n        s.push(e.result), null != e.circularDependencyEndOf && DiInvocationResolver.addValueToKeyValuePairs(r, e.circularDependencyEndOf, t.diMetadata.dependencyName), e.pendingDependencies && Object.keys(e.pendingDependencies).forEach(function (t) {\n          DiInvocationResolver.addValuesToKeyValuePairs(r, t, e.pendingDependencies[t]);\n        });\n      }), {\n        result: n(t, s),\n        pendingDependencies: r\n      };\n    }\n  }, {\n    key: \"invokeChildren\",\n    value: function invokeChildren(t, e, a) {\n      var _this2 = this;\n\n      var n = [];\n      return t.diMetadata.argumentNames.forEach(function (s) {\n        var r = _this2.resolveParamDef(t, s);\n\n        n.push(_this2.invokeChild(t, r, e, a));\n      }), n;\n    }\n  }, {\n    key: \"resolveParamDef\",\n    value: function resolveParamDef(t, e) {\n      var a = t.diMetadata.diParams[e];\n      return null == a ? {\n        name: e,\n        propsProvider: null,\n        payload: e,\n        type: InjectableType.NAME\n      } : a;\n    }\n  }, {\n    key: \"invokeChild\",\n    value: function invokeChild(t, e, a, n) {\n      return e.name === DiRuntime.PROPS_PROPERTY_NAME ? this.resolveChildProps(t) : e.type === InjectableType.TYPE ? this.resolveChildByType(t, e, a, n) : e.type === InjectableType.DYNAMIC ? this.resolveDynamicChild(t, e, a, n) : this.resolveChildByName(t, e, a, n);\n    }\n  }, {\n    key: \"resolveChildProps\",\n    value: function resolveChildProps(t) {\n      if (null == t.properties) throw Error(\"can't resolve properties for $props - There are no properties passed to the beanRuntime\");\n      return {\n        result: t.properties,\n        pendingDependencies: {}\n      };\n    }\n  }, {\n    key: \"resolveChildByType\",\n    value: function resolveChildByType(t, e, a, n) {\n      return this.resolve(this.diInvocationFactory.childrenOf(t, e.payload, e.propsProvider), a, n);\n    }\n  }, {\n    key: \"resolveDynamicChild\",\n    value: function resolveDynamicChild(t, e, a, n) {\n      return this.resolveChildByType(t, {\n        payload: e.payload(),\n        type: InjectableType.TYPE,\n        propsProvider: e.propsProvider,\n        name: e.name\n      }, a, n);\n    }\n  }, {\n    key: \"resolveChildByName\",\n    value: function resolveChildByName(t, e, a, n) {\n      var s = e.payload;\n\n      if (null == t.transitiveBeans || null == t.transitiveBeans[s]) {\n        if (null != a[s]) {\n          return {\n            result: n.invoke(a[s], t.transitiveBeans, a),\n            pendingDependencies: {}\n          };\n        }\n\n        throw Error(\"can't resolve param '\".concat(s, \"' - There are no transitive beans passed into the runtime\"));\n      }\n\n      return {\n        result: t.transitiveBeans[s],\n        pendingDependencies: {}\n      };\n    }\n  }], [{\n    key: \"addValueToKeyValuePairs\",\n    value: function addValueToKeyValuePairs(t, e, a) {\n      t[e] || (t[e] = []), t[e].indexOf(a) > -1 || t[e].push(a);\n    }\n  }, {\n    key: \"addValuesToKeyValuePairs\",\n    value: function addValuesToKeyValuePairs(t, e, a) {\n      t[e] ? a.forEach(function (a) {\n        return DiInvocationResolver.addValueToKeyValuePairs(t, e, a);\n      }) : t[e] = a;\n    }\n  }]);\n\n  return DiInvocationResolver;\n}();\n\nvar DiInvocationBuilderFactory = /*#__PURE__*/function () {\n  function DiInvocationBuilderFactory(t) {\n    _classCallCheck(this, DiInvocationBuilderFactory);\n\n    this.diAnnotationsMetadataFactory = t;\n  }\n\n  _createClass(DiInvocationBuilderFactory, [{\n    key: \"childrenOf\",\n    value: function childrenOf(t, e, a) {\n      var n = t.inProcessDiInvocations.slice(0);\n      return n.push(t.diMetadata.dependencyName), new DiInvocationBuilder(this.diAnnotationsMetadataFactory, e).withInProcessDiInvocations(n).withTransitiveBeans(t.transitiveBeans).if(null != a, function (t) {\n        return t.withProperties(a());\n      });\n    }\n  }, {\n    key: \"root\",\n    value: function root(t) {\n      return new DiInvocationBuilder(this.diAnnotationsMetadataFactory, t);\n    }\n  }]);\n\n  return DiInvocationBuilderFactory;\n}();\n\nvar DiInvocationFactory = /*#__PURE__*/function () {\n  function DiInvocationFactory(t) {\n    _classCallCheck(this, DiInvocationFactory);\n\n    this.diInvocationBuilderFactory = t;\n  }\n\n  _createClass(DiInvocationFactory, [{\n    key: \"childrenOf\",\n    value: function childrenOf(t, e, a) {\n      return this.diInvocationBuilderFactory.childrenOf(t, e, a).build();\n    }\n  }]);\n\n  return DiInvocationFactory;\n}();\n\nvar DiInvocationBuilder = /*#__PURE__*/function () {\n  function DiInvocationBuilder(t, e) {\n    _classCallCheck(this, DiInvocationBuilder);\n\n    this.diAnnotationsMetadataFactory = t, this._constructor = e, this.inProcessDiInvocations = [], this.transitiveBeans = {}, this.properties = null;\n  }\n\n  _createClass(DiInvocationBuilder, [{\n    key: \"if\",\n    value: function _if(t, e) {\n      return t && e(this), this;\n    }\n  }, {\n    key: \"withInProcessDiInvocations\",\n    value: function withInProcessDiInvocations(t) {\n      return this.inProcessDiInvocations = t, this;\n    }\n  }, {\n    key: \"withTransitiveBeans\",\n    value: function withTransitiveBeans(t) {\n      return this.transitiveBeans = t, this;\n    }\n  }, {\n    key: \"withProperties\",\n    value: function withProperties(t) {\n      return this.properties = t, this;\n    }\n  }, {\n    key: \"build\",\n    value: function build() {\n      return {\n        diMetadata: this.diAnnotationsMetadataFactory.create(this._constructor),\n        inProcessDiInvocations: this.inProcessDiInvocations,\n        transitiveBeans: this.transitiveBeans,\n        properties: this.properties\n      };\n    }\n  }]);\n\n  return DiInvocationBuilder;\n}();\n\nvar KeyValueCache = /*#__PURE__*/function () {\n  function KeyValueCache() {\n    _classCallCheck(this, KeyValueCache);\n\n    this.cache = {};\n  }\n\n  _createClass(KeyValueCache, [{\n    key: \"resolve\",\n    value: function resolve(t, e) {\n      if (this.cache[t]) return this.cache[t];\n      if (null == e) throw Error(\"Can't resolve cache\");\n      var a = e();\n      return this.cache[t] = a, a;\n    }\n  }]);\n\n  return KeyValueCache;\n}();\n\nvar DiRuntimeFactory = /*#__PURE__*/function () {\n  function DiRuntimeFactory() {\n    _classCallCheck(this, DiRuntimeFactory);\n  }\n\n  _createClass(DiRuntimeFactory, null, [{\n    key: \"create\",\n    value: function create(t) {\n      return new DiRuntime(DiRuntimeFactory.DI_INVOCATION_RESOLVER_PROVIDER(new KeyValueCache(), t || null), DiRuntimeFactory.DI_INVOCATION_BUILDER_FACTORY);\n    }\n  }]);\n\n  return DiRuntimeFactory;\n}();\n\nDiRuntimeFactory.DI_INVOCATION_BUILDER_FACTORY = new DiInvocationBuilderFactory(new DiAnnotationsMetadataFactory()), DiRuntimeFactory.cacheTBR = function () {\n  return new KeyValueCache();\n}, DiRuntimeFactory.DI_INVOCATION_RESOLVER_PROVIDER = function (t, e) {\n  return new DiInvocationResolver(new DiInvocationFactory(DiRuntimeFactory.DI_INVOCATION_BUILDER_FACTORY), DiRuntimeFactory.cacheTBR(), e);\n};\n\nvar DiContextFactory = /*#__PURE__*/function () {\n  function DiContextFactory() {\n    _classCallCheck(this, DiContextFactory);\n  }\n\n  _createClass(DiContextFactory, null, [{\n    key: \"createContext\",\n    value: function createContext(t, e) {\n      var a,\n          n = DiRuntimeFactory.create(),\n          s = Object.assign(Object.assign({}, t), e);\n      a = e ? [].concat(_toConsumableArray(Object.keys(t)), _toConsumableArray(Object.keys(e))) : Object.keys(t);\n      var r = {},\n          i = Object.assign(Object.assign({}, t), e);\n      return a.forEach(function (t) {\n        var e = s[t];\n        r[t] = n.invoke(e, r, i);\n      }), r;\n    }\n  }]);\n\n  return DiContextFactory;\n}();\n\n!function (t) {\n  t.IDLE = \"IDLE\", t.ASYNC_START = \"ASYNC_START\", t.ASYNC_FULFILLED = \"ASYNC_FULFILLED\", t.ASYNC_CANCELLED = \"ASYNC_CANCELLED\";\n}(exports.MonitorStatus || (exports.MonitorStatus = {}));\nvar ReactStateContext = React.createContext(null);\n\nvar StateMapConnect = /*#__PURE__*/function (_React$Component) {\n  _inherits(StateMapConnect, _React$Component);\n\n  var _super = _createSuper(StateMapConnect);\n\n  function StateMapConnect(t) {\n    var _this3;\n\n    _classCallCheck(this, StateMapConnect);\n\n    _this3 = _super.call(this, t), _this3._isMounted = !1, _this3.lastMonitorInfo = void 0, _this3.lastState = void 0;\n    var e = !0,\n        a = _this3.props.into.prototype ? _this3.props.into.prototype : _this3.props.into.name;\n    _this3._mainDataReactionLock = _this3.props.from.addDataReaction({\n      name: \"connect | \".concat(a),\n      dataConsumer: function dataConsumer(t) {\n        _this3.lastState = t;\n\n        var a = _this3.props.mapper(t, Object.assign({}, _this3.props.from.actions), _this3.lastMonitorInfo);\n\n        _this3._isMounted ? _this3.setState(a) : (e = !1, _this3.state = a);\n      }\n    }), _this3._asyncDataReactionLock = _this3.props.from.addAsyncReaction({\n      name: \"connect monitor| \".concat(a),\n      dataConsumer: function dataConsumer(t) {\n        _this3.lastMonitorInfo = t;\n\n        var a = _this3.props.mapper(_this3.lastState, Object.assign({}, _this3.props.from.actions), t);\n\n        _this3._isMounted ? _this3.setState(a) : (e = !1, _this3.state = a);\n      }\n    }), e && _this3.props.fallbackValue && (_this3.state = _this3.props.fallbackValue(_this3.props.from.actions));\n    return _this3;\n  }\n\n  _createClass(StateMapConnect, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this._isMounted = !0;\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this._isMounted = !1, this._mainDataReactionLock.release(), this._asyncDataReactionLock && this._asyncDataReactionLock.release();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var t = this.props.into;\n      return React.createElement(ReactStateContext.Provider, {\n        value: this.props.from\n      }, React.createElement(t, Object.assign({}, this.state)));\n    }\n  }]);\n\n  return StateMapConnect;\n}(React.Component);\n\nvar StateConnect = function StateConnect(t) {\n  return React.createElement(StateMapConnect, {\n    mapper: function mapper(t, e, a) {\n      return {\n        data: t,\n        actions: e,\n        monitorInfo: a\n      };\n    },\n    into: t.into,\n    from: t.from,\n    fallbackValue: function fallbackValue(e) {\n      return {\n        data: t.fallbackValue,\n        actions: e,\n        monitorInfo: {\n          status: exports.MonitorStatus.IDLE\n        }\n      };\n    }\n  });\n},\n    stateConnect = function stateConnect(t, e, a) {\n  return React.createElement(StateConnect, {\n    from: t,\n    into: e,\n    fallbackValue: a\n  });\n},\n    stateMapConnect = function stateMapConnect(t, e, a, n) {\n  return React.createElement(StateMapConnect, {\n    from: t,\n    into: e,\n    fallbackValue: n,\n    mapper: a\n  });\n};\n\nfunction useFlow(t, e, a) {\n  React.useEffect(function () {\n    t.reactOnStatusChanged(function (t) {\n      e(function (e) {\n        return a ? a(t, e) : t.name;\n      });\n    });\n  }, []);\n}\n\nfunction useFlowStatus(t, e, a, n) {\n  React.useEffect(function () {\n    t.alwaysOn(e, function (t) {\n      a(function (e) {\n        return n ? n(t.getData(), e) : t.getData();\n      });\n    });\n  }, []);\n}\n\nfunction useConanState(t, e) {\n  var a = t.getData();\n\n  var _React$useState = React.useState(null == a ? e : a),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      n = _React$useState2[0],\n      s = _React$useState2[1];\n\n  return React.useEffect(function () {\n    var e = t.addDataReaction({\n      dataConsumer: s,\n      name: \"useConanState[\".concat(t.getName(), \"]\")\n    });\n    return function () {\n      return e.release();\n    };\n  }, []), [n, t.actions, function (_ref) {\n    var e = _ref.children;\n    return React.createElement(ReactStateContext.Provider, {\n      value: t\n    }, e);\n  }];\n}\n\nfunction useContextConanState() {\n  var t = useConanState(React.useContext(ReactStateContext));\n  return [t[0], t[1]];\n}\n\nvar ContextStateMapConnect = /*#__PURE__*/function (_React$Component2) {\n  _inherits(ContextStateMapConnect, _React$Component2);\n\n  var _super2 = _createSuper(ContextStateMapConnect);\n\n  function ContextStateMapConnect() {\n    _classCallCheck(this, ContextStateMapConnect);\n\n    return _super2.apply(this, arguments);\n  }\n\n  _createClass(ContextStateMapConnect, [{\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      return React.createElement(ReactStateContext.Consumer, null, function (t) {\n        if (null == t) throw new Error(\"trying to access the state from the context, but it was not found, did you specify the state up in the rendering tree?\");\n        return React.createElement(StateMapConnect, {\n          from: t,\n          into: _this4.props.into,\n          mapper: _this4.props.mapper,\n          fallbackValue: _this4.props.fallbackValue\n        });\n      });\n    }\n  }]);\n\n  return ContextStateMapConnect;\n}(React.Component);\n\nvar ContextStateConnect = /*#__PURE__*/function (_React$Component3) {\n  _inherits(ContextStateConnect, _React$Component3);\n\n  var _super3 = _createSuper(ContextStateConnect);\n\n  function ContextStateConnect() {\n    _classCallCheck(this, ContextStateConnect);\n\n    return _super3.apply(this, arguments);\n  }\n\n  _createClass(ContextStateConnect, [{\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      return React.createElement(ReactStateContext.Consumer, null, function (t) {\n        if (null == t) throw new Error(\"trying to access the state from the context, but it was not found, did you specify the state up in the rendering tree?\");\n        return React.createElement(StateConnect, {\n          from: t,\n          into: _this5.props.into,\n          fallbackValue: _this5.props.fallbackValue\n        });\n      });\n    }\n  }]);\n\n  return ContextStateConnect;\n}(React.Component);\n\nvar contextStateConnect = function contextStateConnect(t, e) {\n  return React.createElement(ContextStateConnect, {\n    into: t,\n    fallbackValue: e\n  });\n},\n    contextStateMapConnect = function contextStateMapConnect(t, e, a) {\n  return React.createElement(ContextStateMapConnect, {\n    into: t,\n    fallbackValue: a,\n    mapper: e\n  });\n},\n    ContextStateLive = function ContextStateLive(t) {\n  return React.createElement(ContextStateConnect, {\n    into: function into(e) {\n      return t.renderer(e.data, e.actions);\n    },\n    fallbackValue: t.fallbackValue\n  });\n},\n    StateLive = function StateLive(t) {\n  return React.createElement(StateConnect, {\n    from: t.from,\n    into: function into(e) {\n      var a = t.renderer(e.data, e.actions);\n      return Array.isArray(a) ? React.createElement(React.Fragment, null, a) : a;\n    },\n    fallbackValue: t.fallbackValue\n  });\n},\n    contextStateLive = function contextStateLive(t, e) {\n  return React.createElement(ContextStateConnect, {\n    into: function into(e) {\n      var a = t(e.data, e.actions);\n      return Array.isArray(a) ? React.createElement(React.Fragment, null, a) : a;\n    },\n    fallbackValue: e\n  });\n},\n    stateLive = function stateLive(t, e, a) {\n  return React.createElement(StateConnect, {\n    from: t,\n    into: function into(t) {\n      var a = e(t.data, t.actions);\n      return Array.isArray(a) ? React.createElement(React.Fragment, null, a) : a;\n    },\n    fallbackValue: a\n  });\n};\n\nvar MonitorFacade = /*#__PURE__*/function () {\n  function MonitorFacade(t, e) {\n    _classCallCheck(this, MonitorFacade);\n\n    this.monitor = t, this.actions = e;\n  }\n\n  _createClass(MonitorFacade, [{\n    key: \"start\",\n    value: function start() {\n      return this.monitor.start(), this;\n    }\n  }, {\n    key: \"addAsyncReaction\",\n    value: function addAsyncReaction(t) {\n      return this.monitor.addAsyncReaction(t);\n    }\n  }, {\n    key: \"addReaction\",\n    value: function addReaction(t) {\n      return this.monitor.addReaction(t);\n    }\n  }, {\n    key: \"getEvents\",\n    value: function getEvents() {\n      return this.monitor.getEvents();\n    }\n  }, {\n    key: \"getName\",\n    value: function getName() {\n      return this.monitor.getName();\n    }\n  }, {\n    key: \"stop\",\n    value: function stop(t) {\n      this.monitor.stop(t);\n    }\n  }, {\n    key: \"getData\",\n    value: function getData() {\n      return this.monitor.getData();\n    }\n  }, {\n    key: \"next\",\n    value: function next(t) {\n      this.monitor.next(t);\n    }\n  }, {\n    key: \"do\",\n    get: function get() {\n      return this.monitor.do;\n    }\n  }, {\n    key: \"asyncThread\",\n    get: function get() {\n      return this.monitor.asyncThread;\n    }\n  }, {\n    key: \"mainThread\",\n    get: function get() {\n      return this.monitor.mainThread;\n    }\n  }]);\n\n  return MonitorFacade;\n}();\n\nvar Objects = /*#__PURE__*/function () {\n  function Objects() {\n    _classCallCheck(this, Objects);\n  }\n\n  _createClass(Objects, null, [{\n    key: \"mapKeys\",\n    value: function mapKeys(t, e, a) {\n      var n = {};\n      return Object.keys(t).forEach(function (s) {\n        var r = a ? a(s) : s;\n        n[r] = e(t[s]);\n      }), n;\n    }\n  }, {\n    key: \"foreachEntry\",\n    value: function foreachEntry(t, e) {\n      Object.keys(t).forEach(function (a) {\n        e(t[a], a);\n      });\n    }\n  }, {\n    key: \"keyfy\",\n    value: function keyfy(t, e) {\n      return t.reduce(function (t, a) {\n        return Object.assign(Object.assign({}, t), _defineProperty({}, e(a), a));\n      }, {});\n    }\n  }, {\n    key: \"navigate\",\n    value: function navigate(t, e) {\n      var a = [],\n          n = t;\n\n      for (; n;) {\n        null !== (n = e(n)) && a.push(n);\n      }\n\n      return a;\n    }\n  }, {\n    key: \"deepEqualsArrays\",\n    value: function deepEqualsArrays(t, e) {\n      if (t.length !== e.length) return !1;\n\n      var _iterator = _createForOfIteratorHelper(t),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var a = _step.value;\n          if (-1 === e.indexOf(a)) return !1;\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n\n      return !0;\n    }\n  }, {\n    key: \"deepEqualsObjects\",\n    value: function deepEqualsObjects(t, e) {\n      for (var _i = 0, _Object$keys = Object.keys(t); _i < _Object$keys.length; _i++) {\n        var a = _Object$keys[_i];\n        if (!Objects.deepEquals(t[a], e[a])) return !1;\n      }\n\n      return !0;\n    }\n  }, {\n    key: \"deepEquals\",\n    value: function deepEquals(t, e) {\n      return null == t && null == e || (null != t || null == e) && (null == t || null != e) && (\"string\" == typeof t && \"string\" == typeof e ? t === e : \"number\" == typeof t && \"number\" == typeof e ? t === e : \"function\" == typeof t && \"function\" == typeof e ? t === e : \"boolean\" == typeof t && \"boolean\" == typeof e ? t === e : void 0 === t && void 0 === e ? t === e : Array.isArray(t) && Array.isArray(e) ? Objects.deepEqualsArrays(t, e) : !(Array.isArray(t) && !Array.isArray(e)) && !(!Array.isArray(t) && Array.isArray(e)) && (\"object\" == typeof t && \"object\" == typeof e ? Objects.deepEqualsObjects(t, e) : t === e));\n    }\n  }]);\n\n  return Objects;\n}();\n\nvar ReactionType, FlowRuntimeEventSource, FlowRuntimeEventTiming, FlowRuntimeEventType, StatusEventType, BindBackType;\n!function (t) {\n  t.ONCE = \"ONCE\", t.ALWAYS = \"ALWAYS\";\n}(ReactionType || (ReactionType = {}));\n\nvar ThreadImpl = /*#__PURE__*/function () {\n  function ThreadImpl(t) {\n    _classCallCheck(this, ThreadImpl);\n\n    this.flow = t;\n  }\n\n  _createClass(ThreadImpl, [{\n    key: \"start\",\n    value: function start(t) {\n      return this.flow.start(t ? {\n        name: \"nextData\",\n        data: t\n      } : void 0), this;\n    }\n  }, {\n    key: \"next\",\n    value: function next(t) {\n      this.flow.onceOn(\"nextData\", t);\n    }\n  }, {\n    key: \"stop\",\n    value: function stop(t) {\n      this.flow.stop(t);\n    }\n  }, {\n    key: \"chain\",\n    value: function chain(t) {\n      return this.flow.chainInto(\"nextData\", \"nextData\", t).map(function (t) {\n        return t.getData();\n      });\n    }\n  }, {\n    key: \"monitor\",\n    value: function monitor(t, e, a, n) {\n      var s = t.map(function (t) {\n        return function (a) {\n          return e(t, a);\n        };\n      }),\n          r = {\n        payload: n,\n        name: null == a ? \"anonymous\" : a,\n        action: s\n      };\n      return this.flow.deferInto(\"nextData\", \"nextData\", r).map(function (t) {\n        return t.getData();\n      });\n    }\n  }, {\n    key: \"addReaction\",\n    value: function addReaction(t) {\n      var _this6 = this;\n\n      var e = {\n        name: t.name,\n        reactionType: ReactionType.ALWAYS,\n        action: function action(e) {\n          return t.dataConsumer(e.getData());\n        }\n      };\n      return this.flow.addReaction(\"nextData\", e), {\n        release: function release() {\n          _this6.flow.removeReaction(\"nextData\", e);\n        }\n      };\n    }\n  }, {\n    key: \"getData\",\n    value: function getData() {\n      return this.flow.getStatusData().nextData;\n    }\n  }, {\n    key: \"getEvents\",\n    value: function getEvents() {\n      return this.flow.getEvents();\n    }\n  }, {\n    key: \"getName\",\n    value: function getName() {\n      return this.flow.getName();\n    }\n  }, {\n    key: \"isRunning\",\n    get: function get() {\n      return this.flow.isRunning;\n    }\n  }, {\n    key: \"reducers\",\n    get: function get() {\n      return this.flow.on(\"nextData\").steps;\n    }\n  }]);\n\n  return ThreadImpl;\n}();\n\nvar StatusLikeParser = /*#__PURE__*/function () {\n  function StatusLikeParser() {\n    _classCallCheck(this, StatusLikeParser);\n  }\n\n  _createClass(StatusLikeParser, null, [{\n    key: \"parse\",\n    value: function parse(t) {\n      return \"string\" == typeof t ? {\n        name: t\n      } : t;\n    }\n  }]);\n\n  return StatusLikeParser;\n}();\n\nvar FlowRequest = /*#__PURE__*/function () {\n  function FlowRequest(t, e, a, n) {\n    _classCallCheck(this, FlowRequest);\n\n    this.flowThread = t, this.id = e, this.status = a, this.isStep = n, this.queuedReactions = [], this.queuedTransitions = [], this.queuedSteps = [], this.queuedStatuses = [], this.queuedStates = [], this.started = !1, this.processingStatus = {\n      id: this.id,\n      status: this.status\n    };\n  }\n\n  _createClass(FlowRequest, [{\n    key: \"start\",\n    value: function start() {\n      if (this.started) throw new Error(\"unexpected\");\n      this.started = !0, this.flowThread.processStateAndReactions(this.processingStatus, this.isStep), this.flowThread.flagAsSettled(this.processingStatus, this.isStep), this.flowThread.onStateRequestCompleted(this, this.queuedReactions, this.queuedStatuses, this.queuedStates, this.queuedTransitions, this.queuedSteps);\n    }\n  }, {\n    key: \"queueStatus\",\n    value: function queueStatus(t) {\n      this.queuedStatuses.push(t);\n    }\n  }, {\n    key: \"queueTransition\",\n    value: function queueTransition(t) {\n      return this.queuedTransitions.push(t), this;\n    }\n  }, {\n    key: \"queueStep\",\n    value: function queueStep(t) {\n      return this.queuedSteps.push(t), this;\n    }\n  }, {\n    key: \"queueState\",\n    value: function queueState(t) {\n      this.queuedStates.push(t);\n    }\n  }, {\n    key: \"queueReaction\",\n    value: function queueReaction(t, e) {\n      this.queuedReactions.push([t, e]);\n    }\n  }], [{\n    key: \"statusRequest\",\n    value: function statusRequest(t, e, a, n) {\n      return new FlowRequest(t, e, a, n);\n    }\n  }, {\n    key: \"transitionRequest\",\n    value: function transitionRequest(t, e, a, n) {\n      return new FlowRequest(t, e, StatusLikeParser.parse(a.into), n);\n    }\n  }]);\n\n  return FlowRequest;\n}();\n\n!function (t) {\n  t.FLOW_CONTROLLER = \"FLOW_CONTROLLER\", t.FLOW_THREAD = \"FLOW_THREAD\", t.CONTEXT = \"CONTEXT\", t.FLOW_FACTORY = \"FLOW_FACTORY\";\n}(FlowRuntimeEventSource || (FlowRuntimeEventSource = {})), function (t) {\n  t.REQUEST_START = \"REQUEST_START\", t.REQUEST_END = \"REQUEST_END\", t.REQUEST_CANCEL = \"REQUEST_CANCEL\", t.USER_TRACE = \"USER_TRACE\", t.TRACE = \"TRACE\", t.INFO = \"INFO\";\n}(FlowRuntimeEventTiming || (FlowRuntimeEventTiming = {})), function (t) {\n  t.MONITOR = \"MONITOR\", t.PROCESS_REACTIONS = \"PROCESS_REACTIONS\", t.START = \"START\", t.REQUEST_STATUS = \"REQUEST_STATUS\", t.FLAG_AS_SETTLED = \"FLAG_AS_SETTLED\", t.USER_MSG = \"USER_MSG\", t.REQUEST_TRANSITION = \"REQUEST_TRANSITION\", t.CREATE_FLOW = \"CREATE_FLOW\";\n}(FlowRuntimeEventType || (FlowRuntimeEventType = {}));\n\nvar FlowThread = /*#__PURE__*/function () {\n  function FlowThread(t, e, a) {\n    _classCallCheck(this, FlowThread);\n\n    this.flowController = t, this.flowOrchestrator = e, this.flowEvents = a, this.ids = {};\n  }\n\n  _createClass(FlowThread, [{\n    key: \"requestStatus\",\n    value: function requestStatus(t, e) {\n      var a = StatusLikeParser.parse(t),\n          n = this.flowOrchestrator.createRuntimeTracker(this.flowController, FlowRuntimeEventSource.FLOW_THREAD, FlowRuntimeEventType.REQUEST_STATUS, t).highlight(FlowRuntimeEventTiming.REQUEST_START, \"\".concat(a.name));\n      if (this.assertValidStatus(a.name), null != this.currentRequest) return void (e ? (n.trace(FlowRuntimeEventTiming.TRACE, \"queueing state [\".concat(a.name, \"]\")), this.currentRequest.queueState(a)) : (n.trace(FlowRuntimeEventTiming.TRACE, \"queueing status [\".concat(a.name, \"]\")), this.currentRequest.queueStatus(a)));\n      var s = this.getNextId(a);\n      this.currentRequest = FlowRequest.statusRequest(this, s + \"\", a, e), this.currentRequest.start(), n.trace(FlowRuntimeEventTiming.REQUEST_END);\n    }\n  }, {\n    key: \"requestTransition\",\n    value: function requestTransition(t, e) {\n      var a = StatusLikeParser.parse(t.into).name,\n          n = this.flowOrchestrator.createRuntimeTracker(this.flowController, FlowRuntimeEventSource.FLOW_THREAD, FlowRuntimeEventType.REQUEST_TRANSITION, t).highlight(FlowRuntimeEventTiming.REQUEST_START, \"\".concat(t.transitionName));\n      if (n.highlight(FlowRuntimeEventTiming.INFO, e ? \"step\" : \"Transition\", t.transitionName), this.assertValidStatus(a), null != this.currentRequest) return void (e ? (n.trace(FlowRuntimeEventTiming.TRACE, \"queueing step [\".concat(t.transitionName, \"]\")), this.currentRequest.queueStep(t)) : (n.trace(FlowRuntimeEventTiming.TRACE, \"queueing transition [\".concat(t.transitionName, \"]\")), this.currentRequest.queueTransition(t)));\n      var s = this.getNextId(StatusLikeParser.parse(t.into));\n      this.currentRequest = FlowRequest.transitionRequest(this, s + \"\", t, e), this.onTransitionRequested(t, e), this.currentRequest.start(), n.trace(FlowRuntimeEventTiming.REQUEST_END);\n    }\n  }, {\n    key: \"requestStep\",\n    value: function requestStep(t, e, a, n) {\n      this.assertValidStatus(t);\n      var s = this.getCurrentStatusName();\n      if (s !== t) throw new Error(\"car't request step on [\".concat(t, \"] as the current status is[\").concat(s, \"]\"));\n      this.requestTransition({\n        transitionName: e,\n        payload: a,\n        into: {\n          name: t,\n          data: n\n        }\n      }, !0);\n    }\n  }, {\n    key: \"requestState\",\n    value: function requestState(t, e) {\n      this.assertValidStatus(t);\n      var a = this.getCurrentStatusName();\n      if (a !== t) throw new Error(\"car't request state on [\".concat(t, \"] as the current status is[\").concat(a, \"]\"));\n      this.requestStatus({\n        name: t,\n        data: e\n      }, !0);\n    }\n  }, {\n    key: \"tryToQueue\",\n    value: function tryToQueue(t, e) {\n      return null != this.currentRequest && (this.currentRequest.queueReaction(t, e), !0);\n    }\n  }, {\n    key: \"onTransitionRequested\",\n    value: function onTransitionRequested(t, e) {\n      this.flowEvents.addTransition(t, e);\n    }\n  }, {\n    key: \"getNextId\",\n    value: function getNextId(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;\n      null == this.ids[t.name] && (this.ids[t.name] = 0);\n      var a = this.ids[t.name] + 1;\n      return e ? a : (this.ids[t.name] = a, this.ids[t.name]);\n    }\n  }, {\n    key: \"processStateAndReactions\",\n    value: function processStateAndReactions(t, e) {\n      this.flowEvents.addProcessingStatus(t, e), this.flowController.processReactions(t.status.name);\n    }\n  }, {\n    key: \"flagAsSettled\",\n    value: function flagAsSettled(t, e) {\n      var a = this.flowOrchestrator.createRuntimeTracker(this.flowController, FlowRuntimeEventSource.FLOW_THREAD, FlowRuntimeEventType.FLAG_AS_SETTLED, t).highlight(FlowRuntimeEventTiming.REQUEST_START, \"\".concat(t.status.name));\n      this.flowEvents.settleProcessingStatus(t, e), e ? a.highlight(FlowRuntimeEventTiming.INFO, \"STATE\", t.status.data) : a.highlight(FlowRuntimeEventTiming.INFO, \"STATUS\", t.status), a.trace(FlowRuntimeEventTiming.REQUEST_END);\n    }\n  }, {\n    key: \"onStateRequestCompleted\",\n    value: function onStateRequestCompleted(t, e, a, n, s, r) {\n      var _this7 = this;\n\n      if (null == this.currentRequest) throw new Error(\"can't complete the request for [\".concat(this.flowController.getName(), \" - \").concat(t.status.name, \"] as is not flagged as currently in process\"));\n      if (this.currentRequest != t) throw new Error(\"can't complete the request for [\".concat(this.flowController.getName(), \" - \").concat(t.status.name, \"] as it does not match [\").concat(this.currentRequest.status.name, \"]\"));\n      if (s.length > 0 && a.length > 0) throw new Error(\"can't have transitions and states forked at the same time!\");\n      if (this.currentRequest = void 0, s.length > 1 || a.length > 1) throw new Error(\"TBI\");\n      s.forEach(function (t) {\n        return _this7.flowController.requestTransition(t);\n      }), a.forEach(function (t) {\n        return _this7.flowController.requestStatus(t);\n      }), n.forEach(function (t) {\n        return _this7.flowController.requestState(t.name, t.data);\n      }), r.forEach(function (t) {\n        var e = StatusLikeParser.parse(t.into);\n\n        _this7.flowController.requestStep(e.name, t.transitionName, t.payload, e.data);\n      }), e.forEach(function (t) {\n        return _this7.flowController.addReaction(t[0], t[1]);\n      });\n    }\n  }, {\n    key: \"createContext\",\n    value: function createContext(t, e) {\n      var _this8 = this;\n\n      var a = StatusLikeParser.parse(t);\n      return {\n        getData: this.flowController.getState.bind(this.flowController),\n        getStatusData: this.flowController.getStatusData.bind(this.flowController),\n        do: Object.assign(Object.assign({}, this.flowController.on(a.name).transitions), this.flowController.on(a.name).steps),\n        chain: function chain(t) {\n          e(t);\n        },\n        interruptFlow: function interruptFlow() {\n          _this8.flowController.stop();\n        },\n        trace: function trace(t) {\n          var e = _this8.flowOrchestrator.createRuntimeTracker(_this8.flowController, FlowRuntimeEventSource.CONTEXT, FlowRuntimeEventType.USER_MSG, t).highlight(FlowRuntimeEventTiming.REQUEST_START, \"\".concat(t)),\n              a = e.highlight(FlowRuntimeEventTiming.USER_TRACE, void 0, t);\n\n          return e.trace(FlowRuntimeEventTiming.REQUEST_END), a;\n        }\n      };\n    }\n  }, {\n    key: \"getCurrentStatusName\",\n    value: function getCurrentStatusName() {\n      var t = this.flowEvents.currentStatus;\n      return null == t ? void 0 : t.name;\n    }\n  }, {\n    key: \"getCurrentState\",\n    value: function getCurrentState() {\n      var t = this.flowEvents.currentStatus;\n      return null == t ? void 0 : t.data;\n    }\n  }, {\n    key: \"assertValidStatus\",\n    value: function assertValidStatus(t) {\n      if (null == this.flowController.on(t)) throw new Error(\"error requesting a transition into [\".concat(t, \"] unknown status, valid statuses are: [\").concat(Object.keys(this.flowController.getStatusDefs()).join(\", \"), \"]\"));\n    }\n  }]);\n\n  return FlowThread;\n}();\n\n!function (t) {\n  t.TRANSITION = \"TRANSITION\", t.STEP = \"STEP\", t.STATUS = \"STATUS\", t.PROCESSING_STATUS = \"PROCESSING_STATUS\", t.STATE = \"STATE\", t.PROCESSING_STATE = \"PROCESSING_STATE\";\n}(StatusEventType || (StatusEventType = {}));\n\nvar FlowEventsTracker = /*#__PURE__*/function () {\n  function FlowEventsTracker() {\n    _classCallCheck(this, FlowEventsTracker);\n\n    this.eventsByStatus = {}, this.events = [];\n  }\n\n  _createClass(FlowEventsTracker, [{\n    key: \"addTransition\",\n    value: function addTransition(t, e) {\n      var a,\n          n = StatusLikeParser.parse(t.into);\n      a = e ? {\n        type: StatusEventType.STEP,\n        reducerName: t.transitionName,\n        newData: n.data,\n        reducerPayload: t.payload\n      } : {\n        type: StatusEventType.TRANSITION,\n        fromStatus: this.currentStatus.name,\n        intoStatus: n,\n        transitionName: t.transitionName,\n        transitionPayload: t.payload\n      }, this.lastEvent = a, this.process(a);\n    }\n  }, {\n    key: \"addStateFromStatus\",\n    value: function addStateFromStatus(t) {\n      this.lastEvent = t, this.process(t);\n    }\n  }, {\n    key: \"addProcessingStatus\",\n    value: function addProcessingStatus(t, e) {\n      var a;\n      a = e ? {\n        type: StatusEventType.PROCESSING_STATE,\n        data: t.status.data\n      } : {\n        type: StatusEventType.PROCESSING_STATUS,\n        status: t.status\n      }, this.currentStatus = t.status, this.lastEvent = a, this.process(a);\n    }\n  }, {\n    key: \"settleProcessingStatus\",\n    value: function settleProcessingStatus(t, e) {\n      if (e) {\n        if (this.lastEvent.data !== t.status.data) throw new Error(\"unexpected error settling events\");\n        this.lastEvent.type = StatusEventType.STATE, this.eventsByStatus[this.currentStatus.name].lastState = t.status.data;\n      } else {\n        if (this.lastEvent.status !== t.status) throw new Error(\"unexpected error settling events\");\n        this.lastEvent.type = StatusEventType.STATUS, this.addStateFromStatus({\n          data: t.status.data,\n          type: StatusEventType.STATE\n        });\n      }\n    }\n  }, {\n    key: \"process\",\n    value: function process(t) {\n      null == this.eventsByStatus[this.currentStatus.name] && (this.eventsByStatus[this.currentStatus.name] = {\n        allEvents: [],\n        statusName: this.currentStatus.name,\n        lastState: void 0\n      });\n      var e = {\n        event: t,\n        statusName: this.currentStatus.name\n      };\n      this.eventsByStatus[this.currentStatus.name].allEvents.push(e), t.type !== StatusEventType.STATE && t.type !== StatusEventType.PROCESSING_STATE || (this.eventsByStatus[this.currentStatus.name].lastState = t.data), this.events.push(e);\n    }\n  }, {\n    key: \"serializeStatesWithStatus\",\n    value: function serializeStatesWithStatus(t) {\n      return this.serializeWithStatusInfo(Object.assign(Object.assign({}, t), {\n        eventTypes: [StatusEventType.STATE]\n      }));\n    }\n  }, {\n    key: \"serializeStates\",\n    value: function serializeStates(t) {\n      return this.serializeWithStatusInfo(Object.assign(Object.assign({}, t), {\n        eventTypes: [StatusEventType.STATE]\n      })).map(function (t) {\n        return t.event;\n      });\n    }\n  }, {\n    key: \"serializeStatuses\",\n    value: function serializeStatuses(t) {\n      return this.serializeWithStatusInfo(Object.assign(Object.assign({}, t), {\n        eventTypes: [StatusEventType.STATUS]\n      })).map(function (t) {\n        return t.event;\n      });\n    }\n  }, {\n    key: \"serialize\",\n    value: function serialize(t) {\n      return this.serializeWithStatusInfo(t).map(function (t) {\n        return t.event;\n      });\n    }\n  }, {\n    key: \"serializeWithStatusInfo\",\n    value: function serializeWithStatusInfo(t) {\n      var _this9 = this;\n\n      if (!t) return this.events;\n      var e = [];\n      return this.events.forEach(function (a) {\n        var n = !0;\n        n && (t.excludeInit && _this9.eventsByStatus.$init.allEvents.indexOf(a) > -1 && (n = !1), n && (t.excludeStop && _this9.eventsByStatus.$stop && _this9.eventsByStatus.$stop.allEvents.indexOf(a) > -1 && (n = !1), n && (t.statuses && t.statuses.forEach(function (t) {\n          n || -1 === _this9.eventsByStatus[t].allEvents.indexOf(a) && (n = !1);\n        }), n && (t.eventTypes && -1 === t.eventTypes.indexOf(a.event.type) && (n = !1), n && e.push(a)))));\n      }), e;\n    }\n  }, {\n    key: \"getLastStates\",\n    value: function getLastStates() {\n      var _this10 = this;\n\n      var t = {};\n      return Object.keys(this.eventsByStatus).forEach(function (e) {\n        t[e] = _this10.eventsByStatus[e].lastState;\n      }), t;\n    }\n  }, {\n    key: \"getLastState\",\n    value: function getLastState(t) {\n      var e = this.eventsByStatus[t];\n      if (null != e) return e.lastState;\n    }\n  }]);\n\n  return FlowEventsTracker;\n}();\n\n!function (t) {\n  t.STEP = \"STEP\", t.TRANSITION = \"TRANSITION\";\n}(BindBackType || (BindBackType = {}));\n\nvar FlowAnchor = /*#__PURE__*/function () {\n  function FlowAnchor() {\n    _classCallCheck(this, FlowAnchor);\n  }\n\n  _createClass(FlowAnchor, [{\n    key: \"createNewThread\",\n    value: function createNewThread(t, e) {\n      var a = new FlowEventsTracker(),\n          n = new FlowThread(t, e, a);\n      return this.currentThread = {\n        flowEvents: a,\n        flowThread: n\n      }, n;\n    }\n  }, {\n    key: \"getCurrentEvents\",\n    value: function getCurrentEvents() {\n      return this.currentThread.flowEvents;\n    }\n  }, {\n    key: \"getStatusDataProducerFn\",\n    value: function getStatusDataProducerFn() {\n      var _this11 = this;\n\n      return function (t, e) {\n        var a = _this11.currentThread.flowEvents.getLastStates();\n\n        return -1 === Object.keys(a).indexOf(t) ? e : a[t];\n      };\n    }\n  }, {\n    key: \"getDataFn\",\n    value: function getDataFn(t) {\n      var _this12 = this;\n\n      return function () {\n        if (null == _this12.currentThread) throw new Error(\"error getting the data function associated to this flow, this might happen if you try to mutate the state of the flow before it has been started.\");\n        var e = _this12.currentThread.flowEvents.currentStatus.name;\n\n        if (\"$init\" !== e) {\n          if (t !== e) throw new Error(\"unexpected error trying to retrieve the last status for [\".concat(t, \", but the current status is [\").concat(e, \"]]\"));\n          return _this12.currentThread.flowEvents.getLastState(t);\n        }\n      };\n    }\n  }, {\n    key: \"bindBack\",\n    value: function bindBack(t, e, a) {\n      if (!this.currentThread.flowThread.flowController.isRunning) return;\n      var n = e.result && \"$stop\" != e.result.name,\n          s = this.currentStatus && \"$init\" != this.currentStatus.name;\n      if (n && s && (!this.currentStatus || this.currentStatus.name !== t)) throw Error(\"unable to request [\".concat(e.methodName, \"] as is meant for status [\").concat(t, \"], but the current status is [\").concat(this.currentStatus ? this.currentStatus.name : \"-\", \"]\"));\n\n      if (a === BindBackType.STEP) {\n        \"$init\" === this.currentThread.flowThread.getCurrentStatusName() ? this.currentThread.flowThread.requestTransition({\n          into: {\n            name: t,\n            data: e.result\n          },\n          payload: e.payload,\n          transitionName: e.methodName\n        }, !1) : this.currentThread.flowThread.requestStep(e.statusName, e.methodName, e.payload, e.result);\n      } else this.currentThread.flowThread.requestTransition({\n        into: e.result,\n        payload: e.payload,\n        transitionName: e.methodName\n      }, !1);\n    }\n  }, {\n    key: \"getStatusData\",\n    value: function getStatusData() {\n      return this.currentThread.flowEvents.getLastStates();\n    }\n  }, {\n    key: \"currentStatus\",\n    get: function get() {\n      if (this.currentThread) return this.currentThread.flowEvents.currentStatus;\n    }\n  }]);\n\n  return FlowAnchor;\n}();\n\nvar Proxyfier = /*#__PURE__*/function () {\n  function Proxyfier() {\n    _classCallCheck(this, Proxyfier);\n  }\n\n  _createClass(Proxyfier, null, [{\n    key: \"proxy\",\n    value: function proxy(t, e) {\n      var a = {},\n          n = Object.getPrototypeOf(t),\n          s = \"Object\" === n.constructor.name ? t : n;\n      return Object.getOwnPropertyNames(s).forEach(function (n) {\n        if (\"constructor\" === n) return;\n        \"function\" == typeof s[n] && (a[n] = function () {\n          for (var _len = arguments.length, a = new Array(_len), _key = 0; _key < _len; _key++) {\n            a[_key] = arguments[_key];\n          }\n\n          return e(function () {\n            return t[n].apply(t, a);\n          }, {\n            methodName: n,\n            payload: a\n          });\n        });\n      }), a;\n    }\n  }]);\n\n  return Proxyfier;\n}();\n\nvar MutatorsFactory = /*#__PURE__*/function () {\n  function MutatorsFactory() {\n    _classCallCheck(this, MutatorsFactory);\n  }\n\n  _createClass(MutatorsFactory, null, [{\n    key: \"createDefaultStepsDef\",\n    value: function createDefaultStepsDef() {\n      return function (t) {\n        return {\n          $update: function $update(e) {\n            return \"function\" != typeof e ? e : e(t());\n          }\n        };\n      };\n    }\n  }, {\n    key: \"createDefaultTransitionDef\",\n    value: function createDefaultTransitionDef() {\n      return function () {\n        return {\n          $toStatus: function $toStatus(t) {\n            return StatusLikeParser.parse(t);\n          }\n        };\n      };\n    }\n  }, {\n    key: \"createDefaultSteps\",\n    value: function createDefaultSteps(t, e) {\n      return this.createSteps(t, e, this.createDefaultStepsDef());\n    }\n  }, {\n    key: \"createTransitions\",\n    value: function createTransitions(t, e, a) {\n      var n = this.createDefaultTransitionDef();\n      return this.doCreateTransitions(t, e, a ? [a, n] : [n]);\n    }\n  }, {\n    key: \"createSteps\",\n    value: function createSteps(t, e, a) {\n      var n = this.createDefaultStepsDef();\n      return this.doCreateSteps(t, e, a ? [a, n] : [n]);\n    }\n  }, {\n    key: \"doCreateSteps\",\n    value: function doCreateSteps(t, e, a) {\n      var n = e.getDataFn(t),\n          s = {};\n      return a.forEach(function (t) {\n        var e = t(n);\n        s = Object.assign(Object.assign({}, s), e);\n      }), this.bindToAnchor(t, e, s, BindBackType.STEP);\n    }\n  }, {\n    key: \"doCreateTransitions\",\n    value: function doCreateTransitions(t, e, a) {\n      var n = e.getStatusDataProducerFn(),\n          s = {};\n      return a.forEach(function (t) {\n        var e = t(n);\n        s = Object.assign(Object.assign({}, s), e);\n      }), this.bindToAnchor(t, e, s, BindBackType.TRANSITION);\n    }\n  }, {\n    key: \"bindToAnchor\",\n    value: function bindToAnchor(t, e, a, n) {\n      return Proxyfier.proxy(a, function (a, s) {\n        var r = a();\n        return e.bindBack(t, {\n          statusName: e.currentStatus.name,\n          methodName: s.methodName,\n          payload: s.payload,\n          result: r\n        }, n), r;\n      });\n    }\n  }]);\n\n  return MutatorsFactory;\n}();\n\nvar $INIT = \"$init\",\n    $STOP = \"$stop\";\n\nvar ReactionDefLikeParser = /*#__PURE__*/function () {\n  function ReactionDefLikeParser() {\n    _classCallCheck(this, ReactionDefLikeParser);\n  }\n\n  _createClass(ReactionDefLikeParser, null, [{\n    key: \"parse\",\n    value: function parse(t, e, a) {\n      return \"object\" == typeof t ? t : {\n        name: a || \"anonymous\",\n        reactionType: e,\n        action: t\n      };\n    }\n  }]);\n\n  return ReactionDefLikeParser;\n}();\n\nvar FlowDefFactory = /*#__PURE__*/function () {\n  function FlowDefFactory() {\n    _classCallCheck(this, FlowDefFactory);\n  }\n\n  _createClass(FlowDefFactory, null, [{\n    key: \"create\",\n    value: function create(t, e) {\n      var a = FlowDefFactory.statusesByName(t.statuses, e);\n      return a[$INIT] = {\n        name: $INIT,\n        steps: MutatorsFactory.createDefaultSteps($INIT, e),\n        transitions: MutatorsFactory.createTransitions($INIT, e),\n        reactions: t.$onInit ? t.$onInit.map(function (t) {\n          return ReactionDefLikeParser.parse(t, ReactionType.ALWAYS, \"on init\");\n        }) : []\n      }, a[$STOP] = {\n        name: $STOP,\n        steps: MutatorsFactory.createDefaultSteps($STOP, e),\n        transitions: MutatorsFactory.createTransitions($STOP, e),\n        reactions: t.$onStop ? t.$onStop.map(function (t) {\n          return ReactionDefLikeParser.parse(t, ReactionType.ALWAYS, \"on stop\");\n        }) : []\n      }, Object.assign({\n        statusesByStatusName: a,\n        name: t.name\n      }, t.hasOwnProperty(\"initialStatus\") ? {\n        starter: function starter() {\n          return t.initialStatus;\n        }\n      } : void 0);\n    }\n  }, {\n    key: \"statusesByName\",\n    value: function statusesByName(t, e) {\n      var a = {};\n      return Array.isArray(t) ? t.forEach(function (t) {\n        a[t] = {\n          name: t,\n          steps: [],\n          reactions: []\n        };\n      }) : Objects.foreachEntry(t, function (t, n) {\n        a[n] = {\n          name: n,\n          steps: MutatorsFactory.createSteps(n, e, t.steps),\n          transitions: MutatorsFactory.createTransitions(n, e, t.transitions),\n          reactions: t.reactions ? t.reactions.map(function (t) {\n            return ReactionDefLikeParser.parse(t, ReactionType.ALWAYS, \"on[\".concat(n, \"]\"));\n          }) : [],\n          getLastData: e.getDataFn(n)\n        };\n      }), a;\n    }\n  }]);\n\n  return FlowDefFactory;\n}();\n\nvar FlowRuntimeTracker = /*#__PURE__*/function () {\n  function FlowRuntimeTracker(t, e) {\n    _classCallCheck(this, FlowRuntimeTracker);\n\n    this.orchestrator = t, this.event = e;\n  }\n\n  _createClass(FlowRuntimeTracker, [{\n    key: \"trace\",\n    value: function trace(t, e, a) {\n      return this.doTick(t, e, a, {\n        highlight: !1\n      });\n    }\n  }, {\n    key: \"highlight\",\n    value: function highlight(t, e, a) {\n      return this.doTick(t, e, a, {\n        highlight: !0\n      });\n    }\n  }, {\n    key: \"doTick\",\n    value: function doTick(t, e, a, n) {\n      var s = Object.assign(Object.assign(Object.assign({}, this.event), {\n        shortDesc: e,\n        timing: t\n      }), a ? {\n        payload: a\n      } : void 0);\n      return this.orchestrator.onRuntimeEvent(this, s, n), this;\n    }\n  }]);\n\n  return FlowRuntimeTracker;\n}();\n\nvar FlowOrchestrator = /*#__PURE__*/function () {\n  function FlowOrchestrator(t) {\n    _classCallCheck(this, FlowOrchestrator);\n\n    this.eventsProcessor = t, this.pastTrackers = [];\n  }\n\n  _createClass(FlowOrchestrator, [{\n    key: \"onRuntimeEvent\",\n    value: function onRuntimeEvent(t, e, a) {\n      e.timing === FlowRuntimeEventTiming.REQUEST_START ? this.currentTracker = t : e.timing !== FlowRuntimeEventTiming.REQUEST_END && e.timing !== FlowRuntimeEventTiming.REQUEST_CANCEL || (this.pastTrackers.push(t), this.currentTracker = void 0), this.eventsProcessor.forEach(function (t) {\n        return t(e, a);\n      });\n    }\n  }, {\n    key: \"createRuntimeTracker\",\n    value: function createRuntimeTracker(t, e, a, n) {\n      return new FlowRuntimeTracker(this, {\n        flowController: t,\n        source: e,\n        runtimeEvent: a,\n        payload: n\n      });\n    }\n  }]);\n\n  return FlowOrchestrator;\n}();\n\nvar FlowLogger = /*#__PURE__*/function () {\n  function FlowLogger(t) {\n    _classCallCheck(this, FlowLogger);\n\n    this.filters = t;\n  }\n\n  _createClass(FlowLogger, [{\n    key: \"log\",\n    value: function log(t, e) {\n      var _iterator2 = _createForOfIteratorHelper(this.filters),\n          _step2;\n\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var _e = _step2.value;\n          if (!_e(t)) return;\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n\n      var a = t.flowController.getCurrentStatusName();\n      a = a || \"-\", e.highlight ? (console.log(Strings.padEnd(\"\".concat(t.flowController.getName()), 30), Strings.padEnd(\"\".concat(a), 20), Strings.padEnd(\"\".concat(t.runtimeEvent), 20), Strings.padEnd(\"\".concat(t.timing), 20)), (t.payload || t.shortDesc) && (t.shortDesc ? (console.log(\"  =>[\".concat(t.shortDesc, \"]\")), t.payload && console.log(\" \", t.payload)) : console.log(\"  =>[\".concat(t.payload, \"]\"))), console.log(\"------------------------------------------------------------------------------------------------------------------------------------------------\")) : t.shortDesc && console.log(Strings.padEnd(\"\".concat(t.flowController.getName()), 30), Strings.padEnd(\"\".concat(a), 20), Strings.padEnd(\"\".concat(t.runtimeEvent), 20), Strings.padEnd(\"\".concat(t.timing), 20), Strings.padEnd(\"=>\".concat(t.shortDesc), 30));\n    }\n  }]);\n\n  return FlowLogger;\n}();\n\nvar LoggerFilters = /*#__PURE__*/function () {\n  function LoggerFilters() {\n    _classCallCheck(this, LoggerFilters);\n  }\n\n  _createClass(LoggerFilters, null, [{\n    key: \"excludeByLogName\",\n    value: function excludeByLogName(t) {\n      return function (e) {\n        return e.flowController.getName() !== t;\n      };\n    }\n  }, {\n    key: \"excludeByEventTiming\",\n    value: function excludeByEventTiming(t) {\n      return function (e) {\n        return e.timing !== t;\n      };\n    }\n  }]);\n\n  return LoggerFilters;\n}();\n\nvar FLOW_LOGGER = new FlowLogger([LoggerFilters.excludeByEventTiming(FlowRuntimeEventTiming.REQUEST_END), LoggerFilters.excludeByEventTiming(FlowRuntimeEventTiming.REQUEST_START), LoggerFilters.excludeByLogName(\"next-promise\")]);\n\nfunction isPromise(t) {\n  return null != t && \"object\" == typeof t && \"then\" in t && \"function\" == typeof t.then;\n}\n\nfunction isAsap(t) {\n  return t instanceof NowImpl || t instanceof LaterImpl;\n}\n\n!function (t) {\n  t.NOW = \"NOW\", t.LATER = \"LATER\";\n}(exports.AsapType || (exports.AsapType = {}));\n\nvar NowImpl = /*#__PURE__*/function () {\n  function NowImpl(t) {\n    _classCallCheck(this, NowImpl);\n\n    this.rawValue = t, this.type = exports.AsapType.NOW;\n  }\n\n  _createClass(NowImpl, [{\n    key: \"cancel\",\n    value: function cancel() {\n      return !1;\n    }\n  }, {\n    key: \"then\",\n    value: function then(t) {\n      return t(this.rawValue), this;\n    }\n  }, {\n    key: \"map\",\n    value: function map(t) {\n      return Asaps.now(t(this.rawValue));\n    }\n  }, {\n    key: \"merge\",\n    value: function merge(t) {\n      var _Asaps$next = Asaps.next(),\n          _Asaps$next2 = _slicedToArray(_Asaps$next, 2),\n          e = _Asaps$next2[0],\n          a = _Asaps$next2[1];\n\n      return this.then(function (a) {\n        return t(a).then(function (t) {\n          return e(t);\n        });\n      }), a;\n    }\n  }, {\n    key: \"catch\",\n    value: function _catch(t) {\n      return this;\n    }\n  }, {\n    key: \"onCancel\",\n    value: function onCancel(t) {\n      return this;\n    }\n  }]);\n\n  return NowImpl;\n}();\n\nvar LaterImpl = /*#__PURE__*/function () {\n  function LaterImpl(t) {\n    _classCallCheck(this, LaterImpl);\n\n    this.flow = t, this.type = exports.AsapType.LATER;\n  }\n\n  _createClass(LaterImpl, [{\n    key: \"map\",\n    value: function map(t) {\n      var _Asaps$next3 = Asaps.next(),\n          _Asaps$next4 = _slicedToArray(_Asaps$next3, 2),\n          e = _Asaps$next4[0],\n          a = _Asaps$next4[1];\n\n      return this.then(function (a) {\n        return e(t(a));\n      }), this.onCancel(function () {\n        return a.cancel();\n      }), a;\n    }\n  }, {\n    key: \"then\",\n    value: function then(t) {\n      return \"resolved\" === this.flow.getCurrentStatusName() ? t(this.flow.on(\"resolved\").getLastData()) : this.flow.on(\"resolving\").steps.$update(function (e) {\n        return Object.assign(Object.assign({}, e), {\n          then: [].concat(_toConsumableArray(e.then), [t])\n        });\n      }), this;\n    }\n  }, {\n    key: \"resolve\",\n    value: function resolve(t) {\n      var _this13 = this;\n\n      if (\"cancelled\" !== this.flow.getCurrentStatusName()) try {\n        this.flow.assertOn(\"resolving\", function (e) {\n          e.getData().then.forEach(function (e) {\n            e(t);\n          }), _this13.flow.on(\"resolving\").transitions.$toStatus({\n            name: \"resolved\",\n            data: t\n          });\n        });\n      } catch (e) {\n        console.error(e), this.flow.assertOn(\"resolving\", function (a) {\n          a.getData().catch.forEach(function (a) {\n            a(e, t);\n          }), a.do.$toStatus({\n            name: \"errored\",\n            data: t\n          });\n        });\n      }\n    }\n  }, {\n    key: \"onCancel\",\n    value: function onCancel(t) {\n      if (\"cancelled\" !== this.flow.getCurrentStatusName()) return \"resolving\" === this.flow.getCurrentStatusName() && this.flow.on(\"resolving\").steps.$update(function (e) {\n        return Object.assign(Object.assign({}, e), {\n          onCancel: [].concat(_toConsumableArray(e.onCancel), [t])\n        });\n      }), this;\n      t();\n    }\n  }, {\n    key: \"cancel\",\n    value: function cancel() {\n      var _this14 = this;\n\n      return \"resolving\" === this.flow.getCurrentStatusName() && (this.flow.assertOn(\"resolving\", function (t) {\n        t.getData().onCancel.forEach(function (t) {\n          t();\n        }), _this14.flow.on(\"resolving\").transitions.$toStatus({\n          name: \"cancelled\"\n        });\n      }), !0);\n    }\n  }, {\n    key: \"merge\",\n    value: function merge(t) {\n      var _Asaps$next5 = Asaps.next(),\n          _Asaps$next6 = _slicedToArray(_Asaps$next5, 2),\n          e = _Asaps$next6[0],\n          a = _Asaps$next6[1];\n\n      return this.then(function (n) {\n        return t(n).then(function (t) {\n          return e(t);\n        }).onCancel(function () {\n          return a.cancel();\n        });\n      }).onCancel(function () {\n        return a.cancel();\n      }), a;\n    }\n  }, {\n    key: \"catch\",\n    value: function _catch(t) {\n      return \"resolving\" === this.flow.getCurrentStatusName() && this.flow.on(\"resolving\").steps.$update(function (e) {\n        return Object.assign(Object.assign({}, e), {\n          catch: [].concat(_toConsumableArray(e.catch), [t])\n        });\n      }), this;\n    }\n  }]);\n\n  return LaterImpl;\n}();\n\nvar AsapParser = /*#__PURE__*/function () {\n  function AsapParser() {\n    _classCallCheck(this, AsapParser);\n  }\n\n  _createClass(AsapParser, null, [{\n    key: \"from\",\n    value: function from(t) {\n      return isAsap(t) ? t : isPromise(t) ? Asaps.fromPromise(t) : Asaps.now(t);\n    }\n  }]);\n\n  return AsapParser;\n}();\n\nvar Asaps = /*#__PURE__*/function () {\n  function Asaps() {\n    _classCallCheck(this, Asaps);\n  }\n\n  _createClass(Asaps, null, [{\n    key: \"now\",\n    value: function now(t) {\n      return new NowImpl(t);\n    }\n  }, {\n    key: \"fromPromise\",\n    value: function fromPromise(t) {\n      var e = new LaterImpl(Flows.createController({\n        name: \"next-promise\",\n        statuses: {\n          resolving: {},\n          resolved: {},\n          errored: {},\n          cancelled: {}\n        },\n        initialStatus: {\n          name: \"resolving\",\n          data: {\n            then: [],\n            catch: [],\n            onCancel: []\n          }\n        }\n      }).start());\n      return t.then(function (t) {\n        return e.resolve(t);\n      }), t.catch(function (t) {\n        return e.catch(t);\n      }), e;\n    }\n  }, {\n    key: \"delayed\",\n    value: function delayed(t, e) {\n      return Asaps.fromPromise(new Promise(function (a) {\n        return setTimeout(function () {\n          return a(t);\n        }, e);\n      }));\n    }\n  }, {\n    key: \"fetch\",\n    value: function (_fetch) {\n      function fetch(_x) {\n        return _fetch.apply(this, arguments);\n      }\n\n      fetch.toString = function () {\n        return _fetch.toString();\n      };\n\n      return fetch;\n    }(function (t) {\n      return Asaps.fromPromise(new Promise(function (e) {\n        fetch(t).then(function (t) {\n          return t.json();\n        }).then(function (t) {\n          e(t);\n        });\n      }));\n    })\n  }, {\n    key: \"next\",\n    value: function next() {\n      var t = new LaterImpl(Flows.createController({\n        name: \"next-promise\",\n        statuses: {\n          resolving: {},\n          resolved: {},\n          errored: {},\n          cancelled: {}\n        },\n        initialStatus: {\n          name: \"resolving\",\n          data: {\n            then: [],\n            catch: [],\n            onCancel: []\n          }\n        }\n      }).start());\n      return [function (e) {\n        return t.resolve(e);\n      }, t];\n    }\n  }]);\n\n  return Asaps;\n}();\n\nfunction deferParser(t, e) {\n  return isAsap(t) ? {\n    action: t,\n    name: e.name,\n    payload: e.payload\n  } : t;\n}\n\nvar FlowImpl = /*#__PURE__*/function () {\n  function FlowImpl(t, e, a) {\n    _classCallCheck(this, FlowImpl);\n\n    this.flowDef = t, this.flowAnchor = e, this.flowOrchestrator = a, this.isRunning = !1;\n  }\n\n  _createClass(FlowImpl, [{\n    key: \"start\",\n    value: function start(t) {\n      var _this15 = this;\n\n      var e = this.flowOrchestrator.createRuntimeTracker(this, FlowRuntimeEventSource.FLOW_CONTROLLER, FlowRuntimeEventType.START, t).trace(FlowRuntimeEventTiming.REQUEST_START);\n      if (this.isRunning) throw new Error(\"can't request a flow that it has been started to start again\");\n      if (this.flowThread = this.flowAnchor.createNewThread(this, this.flowOrchestrator), this.isRunning = !0, null == t && null == this.flowDef.starter) return this.requestStatus($INIT), this;\n\n      var a = t || this.flowDef.starter(),\n          n = function n(t) {\n        _this15.addReaction($INIT, {\n          action: function action() {\n            e.highlight(FlowRuntimeEventTiming.TRACE, \"initialStatus - resolved\", t), _this15.requestStatus(t);\n          },\n          reactionType: ReactionType.ONCE,\n          name: \"to initial state\"\n        }), _this15.addReaction($STOP, {\n          name: \"onStop=>notifyEvents\",\n          reactionType: ReactionType.ONCE,\n          action: function action(t) {\n            t.chain(function () {\n              e.highlight(FlowRuntimeEventTiming.TRACE, \"state machine stopped\"), _this15.flowThread = null, _this15.isRunning = !1;\n            });\n          }\n        }), _this15.requestStatus($INIT);\n      };\n\n      return AsapParser.from(a).then(function (t) {\n        return n(t);\n      }), e.trace(FlowRuntimeEventTiming.REQUEST_END), this;\n    }\n  }, {\n    key: \"requestStatus\",\n    value: function requestStatus(t) {\n      var e = StatusLikeParser.parse(t).name;\n\n      if (this.isRunning) {\n        if (null == this.on(e)) throw new Error(\"unable to request non existing status [\".concat(e, \"]\"));\n        this.flowThread.requestStatus(t, !1);\n      }\n    }\n  }, {\n    key: \"requestState\",\n    value: function requestState(t, e) {\n      this.isRunning && this.flowThread.requestState(t, e);\n    }\n  }, {\n    key: \"requestTransition\",\n    value: function requestTransition(t) {\n      if (this.isRunning) return this.flowThread.requestTransition(t, !1), this;\n    }\n  }, {\n    key: \"requestStep\",\n    value: function requestStep(t, e, a, n) {\n      this.isRunning && this.flowThread.requestStep(t, e, a, n);\n    }\n  }, {\n    key: \"stop\",\n    value: function stop(t) {\n      var _this16 = this;\n\n      if (!this.isRunning) throw new Error(\"unexpected\");\n      return this.addReaction($STOP, {\n        name: \"onStop=>notifyEvents\",\n        reactionType: ReactionType.ONCE,\n        action: function action() {\n          t && t(_this16.flowAnchor.getCurrentEvents());\n        }\n      }), this.requestStatus({\n        name: $STOP\n      }), this;\n    }\n  }, {\n    key: \"alwaysOn\",\n    value: function alwaysOn(t, e) {\n      return this.addReaction(t, {\n        name: \"-\",\n        reactionType: ReactionType.ALWAYS,\n        action: e\n      });\n    }\n  }, {\n    key: \"onceOnInit\",\n    value: function onceOnInit(t) {\n      return this.onceOn($INIT, t);\n    }\n  }, {\n    key: \"onceOnStop\",\n    value: function onceOnStop(t) {\n      return this.onceOn($STOP, t);\n    }\n  }, {\n    key: \"onceOn\",\n    value: function onceOn(t, e) {\n      return this.addReaction(t, {\n        name: \"-\",\n        reactionType: ReactionType.ONCE,\n        action: e\n      });\n    }\n  }, {\n    key: \"addReaction\",\n    value: function addReaction(t, e) {\n      var a = !0;\n\n      if (this.isRunning) {\n        if (this.flowThread.tryToQueue(t, e)) return this;\n        this.runIf(t, {\n          action: function action(t) {\n            e.action(t), e.reactionType === ReactionType.ONCE && (a = !1);\n          },\n          reactionType: e.reactionType,\n          name: e.name\n        });\n      }\n\n      if (a) {\n        var _a2 = this.on(t);\n\n        if (null == _a2) throw new Error(\"unable to add reactions for unknown event [\".concat(t, \"]\"));\n        this.addReactionNext(_a2, e);\n      }\n\n      return this;\n    }\n  }, {\n    key: \"addReactionNext\",\n    value: function addReactionNext(t, e) {\n      return t.reactions.push(e), this;\n    }\n  }, {\n    key: \"getReactions\",\n    value: function getReactions(t) {\n      var e = this.on(t);\n      if (null == e) throw new Error(\"can't getReactions for unknown status[\".concat(t, \"]\"));\n      return e.reactions;\n    }\n  }, {\n    key: \"getCurrentStatusName\",\n    value: function getCurrentStatusName() {\n      if (void 0 != this.flowThread) return this.flowThread.getCurrentStatusName();\n    }\n  }, {\n    key: \"getEvents\",\n    value: function getEvents() {\n      return this.flowAnchor.getCurrentEvents();\n    }\n  }, {\n    key: \"getName\",\n    value: function getName() {\n      return this.flowDef.name;\n    }\n  }, {\n    key: \"getState\",\n    value: function getState() {\n      return this.flowThread.getCurrentState();\n    }\n  }, {\n    key: \"getStatusData\",\n    value: function getStatusData() {\n      return this.flowAnchor.getStatusData();\n    }\n  }, {\n    key: \"onInit\",\n    value: function onInit() {\n      return this.on($INIT);\n    }\n  }, {\n    key: \"on\",\n    value: function on(t) {\n      return this.flowDef.statusesByStatusName[t];\n    }\n  }, {\n    key: \"getStatusDefs\",\n    value: function getStatusDefs() {\n      return this.flowDef.statusesByStatusName;\n    }\n  }, {\n    key: \"removeReaction\",\n    value: function removeReaction(t, e) {\n      var a = this.on(t),\n          n = a.reactions;\n      n && (a.reactions = n.filter(function (t) {\n        return t !== e;\n      }));\n    }\n  }, {\n    key: \"processReactions\",\n    value: function processReactions(t) {\n      var _this17 = this;\n\n      var e,\n          a = this.flowOrchestrator.createRuntimeTracker(this, FlowRuntimeEventSource.FLOW_CONTROLLER, FlowRuntimeEventType.PROCESS_REACTIONS, t).trace(FlowRuntimeEventTiming.REQUEST_START);\n      return this.getReactions(t).forEach(function (a) {\n        a.reactionType === ReactionType.ONCE && _this17.removeReaction(t, a), a.action(_this17.flowThread.createContext(t, function (t) {\n          return e = t;\n        }));\n      }), e && e(), a.trace(FlowRuntimeEventTiming.REQUEST_END, t), this;\n    }\n  }, {\n    key: \"getStateData\",\n    value: function getStateData() {\n      throw new Error(\"TBI\");\n    }\n  }, {\n    key: \"reactOnStatusChanged\",\n    value: function reactOnStatusChanged(t) {\n      var _this18 = this;\n\n      return Object.keys(this.getStatusDefs()).forEach(function (e) {\n        _this18.addReaction(e, {\n          name: \"-\",\n          reactionType: ReactionType.ALWAYS,\n          action: function action(a) {\n            return t({\n              name: e,\n              data: a.getData()\n            });\n          }\n        });\n      }), this;\n    }\n  }, {\n    key: \"runIf\",\n    value: function runIf(t, e, a) {\n      if (!this.isRunning) return void (a && a());\n      var n = this.getCurrentStatusName();\n      null != n && n === t ? this.doRun(e, t) : a && a();\n    }\n  }, {\n    key: \"doRun\",\n    value: function doRun(t, e) {\n      t.action(this.flowThread.createContext(e, function (t) {\n        return t();\n      }));\n    }\n  }, {\n    key: \"assertOn\",\n    value: function assertOn(t, e) {\n      var a = this.getCurrentStatusName();\n      if (a !== t) throw new Error(\"asserting that we are on the status [\".concat(t, \"]. But we are currently on [\").concat(a, \"]\"));\n      return e && this.onceOn(t, function (t) {\n        return e(t);\n      }), this;\n    }\n  }, {\n    key: \"chainInto\",\n    value: function chainInto(t, e, a) {\n      var _Asaps$next7 = Asaps.next(),\n          _Asaps$next8 = _slicedToArray(_Asaps$next7, 2),\n          n = _Asaps$next8[0],\n          s = _Asaps$next8[1];\n\n      if (\"$init\" !== this.getCurrentStatusName()) this.assertOn(t), this.addReactionNext(this.on(e), {\n        name: \"once on next\",\n        reactionType: ReactionType.ONCE,\n        action: function action(t) {\n          return n(t);\n        }\n      }), this.onceOn(t, function (t) {\n        return a(t.do);\n      });else {\n        var _t = this.getStatusDefs()[e];\n        this.onceOn(\"$init\", function () {\n          return a(_t.steps);\n        });\n      }\n      return s;\n    }\n  }, {\n    key: \"deferInto\",\n    value: function deferInto(t, e, a) {\n      var _this19 = this;\n\n      var n = deferParser(a, {\n        name: \"[\".concat(this.getName(), \"]::\").concat(t, \"=>\").concat(e),\n        payload: \"[\".concat(this.getName(), \"]::\").concat(t, \"=>\").concat(e)\n      }),\n          s = this.flowOrchestrator.createRuntimeTracker(this, FlowRuntimeEventSource.FLOW_CONTROLLER, FlowRuntimeEventType.MONITOR, {\n        asap: n.action,\n        name: n.name,\n        payload: n.payload\n      }).trace(FlowRuntimeEventTiming.REQUEST_START);\n      return n.action.merge(function (a) {\n        return s.trace(FlowRuntimeEventTiming.REQUEST_END), _this19.chainInto(t, e, a);\n      }).onCancel(function () {\n        s.trace(FlowRuntimeEventTiming.REQUEST_CANCEL);\n      });\n    }\n  }]);\n\n  return FlowImpl;\n}();\n\nvar FlowFacadeImpl = /*#__PURE__*/function () {\n  function FlowFacadeImpl(t, e) {\n    _classCallCheck(this, FlowFacadeImpl);\n\n    this.flow = t, this.actions = e, this.do = e;\n  }\n\n  _createClass(FlowFacadeImpl, [{\n    key: \"addReaction\",\n    value: function addReaction(t, e) {\n      return this.flow.addReaction(t, e), this;\n    }\n  }, {\n    key: \"alwaysOn\",\n    value: function alwaysOn(t, e) {\n      return this.flow.alwaysOn(t, e), this;\n    }\n  }, {\n    key: \"assertOn\",\n    value: function assertOn(t, e) {\n      return this.flow.assertOn(t, e), this;\n    }\n  }, {\n    key: \"chainInto\",\n    value: function chainInto(t, e, a) {\n      this.flow.chainInto(t, e, a);\n    }\n  }, {\n    key: \"getCurrentStatusName\",\n    value: function getCurrentStatusName() {\n      return this.flow.getCurrentStatusName();\n    }\n  }, {\n    key: \"getEvents\",\n    value: function getEvents() {\n      return this.flow.getEvents();\n    }\n  }, {\n    key: \"getName\",\n    value: function getName() {\n      return this.flow.getName();\n    }\n  }, {\n    key: \"getState\",\n    value: function getState() {\n      return this.flow.getState();\n    }\n  }, {\n    key: \"getStatusData\",\n    value: function getStatusData() {\n      return this.flow.getStatusData();\n    }\n  }, {\n    key: \"on\",\n    value: function on(t) {\n      return this.flow.on(t);\n    }\n  }, {\n    key: \"onceOn\",\n    value: function onceOn(t, e) {\n      return this.flow.onceOn(t, e), this;\n    }\n  }, {\n    key: \"onceOnInit\",\n    value: function onceOnInit(t) {\n      return this.flow.onceOnInit(t), this;\n    }\n  }, {\n    key: \"onceOnStop\",\n    value: function onceOnStop(t) {\n      return this.flow.onceOnStop(t), this;\n    }\n  }, {\n    key: \"start\",\n    value: function start(t) {\n      return this.flow.start(t), this;\n    }\n  }, {\n    key: \"stop\",\n    value: function stop(t) {\n      return this.flow.stop(t), this;\n    }\n  }, {\n    key: \"onInit\",\n    value: function onInit() {\n      return this.flow.onInit();\n    }\n  }, {\n    key: \"reactOnStatusChanged\",\n    value: function reactOnStatusChanged(t) {\n      return this.flow.reactOnStatusChanged(t), this;\n    }\n  }, {\n    key: \"deferInto\",\n    value: function deferInto(t, e, a) {\n      return this.flow.deferInto(t, e, a);\n    }\n  }, {\n    key: \"removeReaction\",\n    value: function removeReaction(t, e) {\n      this.flow.removeReaction(t, e);\n    }\n  }, {\n    key: \"isRunning\",\n    get: function get() {\n      return this.flow.isRunning;\n    }\n  }]);\n\n  return FlowFacadeImpl;\n}();\n\nvar FlowOrchestrator$ = function FlowOrchestrator$(t) {\n  return new FlowOrchestrator([function (t, e) {\n    return FLOW_LOGGER.log(t, e);\n  }].concat(_toConsumableArray(t)));\n};\n\nvar Flows = /*#__PURE__*/function () {\n  function Flows() {\n    _classCallCheck(this, Flows);\n  }\n\n  _createClass(Flows, null, [{\n    key: \"create\",\n    value: function create(t) {\n      var e = this.createController(t);\n      return this.createFacade(e, t.actions);\n    }\n  }, {\n    key: \"createFacade\",\n    value: function createFacade(t, e) {\n      return new FlowFacadeImpl(t, e ? e(t) : void 0);\n    }\n  }, {\n    key: \"createController\",\n    value: function createController(t) {\n      var e = new FlowAnchor(),\n          a = FlowOrchestrator$(t.pipelineListener ? [t.pipelineListener] : []),\n          n = new FlowImpl(FlowDefFactory.create(t, e), e, a);\n      return a.createRuntimeTracker(n, FlowRuntimeEventSource.FLOW_FACTORY, FlowRuntimeEventType.CREATE_FLOW, t).trace(FlowRuntimeEventTiming.REQUEST_START).trace(FlowRuntimeEventTiming.REQUEST_END, n), n;\n    }\n  }]);\n\n  return Flows;\n}();\n\nvar ThreadFacade = /*#__PURE__*/function () {\n  function ThreadFacade(t, e) {\n    _classCallCheck(this, ThreadFacade);\n\n    this.thread = t, this.actions = e;\n  }\n\n  _createClass(ThreadFacade, [{\n    key: \"chain\",\n    value: function chain(t) {\n      this.thread.chain(t);\n    }\n  }, {\n    key: \"next\",\n    value: function next(t) {\n      this.thread.next(t);\n    }\n  }, {\n    key: \"start\",\n    value: function start() {\n      return this.thread.start(), this;\n    }\n  }, {\n    key: \"stop\",\n    value: function stop(t) {\n      return this.thread.stop(t), this;\n    }\n  }, {\n    key: \"addReaction\",\n    value: function addReaction(t) {\n      return this.thread.addReaction(t);\n    }\n  }, {\n    key: \"getData\",\n    value: function getData() {\n      return this.thread.getData();\n    }\n  }, {\n    key: \"getEvents\",\n    value: function getEvents() {\n      return this.thread.getEvents();\n    }\n  }, {\n    key: \"getName\",\n    value: function getName() {\n      return this.thread.getName();\n    }\n  }, {\n    key: \"do\",\n    get: function get() {\n      var t = this.reducers;\n      return Object.assign(Object.assign({}, t), this.actions);\n    }\n  }, {\n    key: \"reducers\",\n    get: function get() {\n      return this.thread.reducers;\n    }\n  }, {\n    key: \"isRunning\",\n    get: function get() {\n      return this.thread.isRunning;\n    }\n  }]);\n\n  return ThreadFacade;\n}();\n\nvar MethodFinder = /*#__PURE__*/function () {\n  function MethodFinder() {\n    _classCallCheck(this, MethodFinder);\n  }\n\n  _createClass(MethodFinder, null, [{\n    key: \"exists\",\n    value: function exists(t, e) {\n      return null != t && this.find(t, e).length > 0;\n    }\n  }, {\n    key: \"find\",\n    value: function find(t) {\n      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n      var a = Object.getPrototypeOf(t),\n          n = \"Object\" === a.constructor.name ? t : a;\n      return Object.getOwnPropertyNames(n).filter(function (t) {\n        return t.startsWith(e);\n      });\n    }\n  }]);\n\n  return MethodFinder;\n}();\n\nvar Threads = /*#__PURE__*/function () {\n  function Threads() {\n    _classCallCheck(this, Threads);\n  }\n\n  _createClass(Threads, null, [{\n    key: \"create\",\n    value: function create(t) {\n      var e,\n          a = Flows.createController(Object.assign(Object.assign({\n        name: t.name,\n        statuses: {\n          nextData: Object.assign(Object.assign({}, t.reducers ? {\n            steps: t.reducers\n          } : void 0), t.reactions ? {\n            reactions: t.reactions\n          } : void 0)\n        }\n      }, t.hasOwnProperty(\"initialData\") ? {\n        initialStatus: AsapParser.from(t.initialData).map(function (t) {\n          return {\n            name: \"nextData\",\n            data: t\n          };\n        })\n      } : void 0), {\n        pipelineListener: t.pipelineListener\n      })),\n          n = new ThreadImpl(a);\n      if (t.actions && t.autoBind) throw new Error(\"you can only use actions or autoBind. Both in conjunction is illegal\");\n\n      if (t.autoBind) {\n        var _a3 = [],\n            s = Object.assign({}, t.autoBind);\n        Object.keys(n.reducers).forEach(function (e) {\n          var r = e.substring(1, e.length);\n          MethodFinder.exists(t.autoBind, r) ? (s[r] = function () {\n            var _t$autoBind;\n\n            return (_t$autoBind = t.autoBind)[r].apply(_t$autoBind, arguments);\n          }, _a3.push(r)) : s[r] = function () {\n            for (var _len2 = arguments.length, t = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n              t[_key2] = arguments[_key2];\n            }\n\n            return n.chain(function (a) {\n              return a[e].apply(a, t);\n            });\n          };\n        }), e = new ThreadFacade(n, Proxyfier.proxy(s, function (t, e) {\n          return -1 === _a3.indexOf(e.methodName) ? t() : n.monitor(t(), function (t, a) {\n            return a[\"$\".concat(e.methodName)](t);\n          }, e.methodName, e.payload);\n        }));\n      } else {\n        var _a4 = t.actions ? t.actions(n) : {};\n\n        Object.keys(n.reducers).forEach(function (t) {\n          var e = t.substring(1, t.length);\n          _a4[e] || (_a4[e] = function () {\n            for (var _len3 = arguments.length, e = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n              e[_key3] = arguments[_key3];\n            }\n\n            return n.chain(function (a) {\n              return a[t].apply(a, e);\n            });\n          });\n        }), e = new ThreadFacade(n, _a4);\n      }\n\n      return t.cancelAutoStart || e.start(), e;\n    }\n  }]);\n\n  return Threads;\n}();\n\nvar PipeImpl = /*#__PURE__*/function () {\n  function PipeImpl(t, e, a) {\n    _classCallCheck(this, PipeImpl);\n\n    this.name = t, this.pipeConnector = e, this.pipeThreadDef = a;\n  }\n\n  _createClass(PipeImpl, [{\n    key: \"addReaction\",\n    value: function addReaction(t) {\n      return this.baseThread.addReaction(t);\n    }\n  }, {\n    key: \"chain\",\n    value: function chain(t) {\n      return this.baseThread.chain(t);\n    }\n  }, {\n    key: \"getData\",\n    value: function getData() {\n      return this.baseThread.getData();\n    }\n  }, {\n    key: \"getEvents\",\n    value: function getEvents() {\n      return this.baseThread.getEvents();\n    }\n  }, {\n    key: \"getName\",\n    value: function getName() {\n      return this.baseThread.getName();\n    }\n  }, {\n    key: \"next\",\n    value: function next(t) {\n      this.baseThread.next(t);\n    }\n  }, {\n    key: \"start\",\n    value: function start() {\n      if (null == this.baseThread) {\n        var t = Object.assign({\n          name: this.name\n        }, this.pipeThreadDef);\n        this.baseThread = Threads.create(t), this.pipeConnector(this.baseThread);\n      } else this.baseThread.start();\n\n      return this;\n    }\n  }, {\n    key: \"stop\",\n    value: function stop(t) {\n      return this.baseThread.stop(void 0), this;\n    }\n  }, {\n    key: \"reducers\",\n    get: function get() {\n      return this.baseThread.reducers;\n    }\n  }, {\n    key: \"isRunning\",\n    get: function get() {\n      return this.baseThread.isRunning;\n    }\n  }, {\n    key: \"do\",\n    get: function get() {\n      return this.baseThread.do;\n    }\n  }, {\n    key: \"actions\",\n    get: function get() {\n      return this.baseThread.actions;\n    }\n  }, {\n    key: \"thread\",\n    get: function get() {\n      return this.baseThread.thread;\n    }\n  }]);\n\n  return PipeImpl;\n}();\n\nvar Pipes = /*#__PURE__*/function () {\n  function Pipes() {\n    _classCallCheck(this, Pipes);\n  }\n\n  _createClass(Pipes, null, [{\n    key: \"fromMonitor\",\n    value: function fromMonitor(t, e, a, n) {\n      return Pipes.filter(\"unique-monitor\", Pipes.merge(\"pipeMonitor=>raw[\".concat(t.getName(), \"]\"), t.asyncThread, e, t.mainThread, a, n), function (t, e) {\n        return !Objects.deepEquals(t, e);\n      });\n    }\n  }, {\n    key: \"map\",\n    value: function map(t, e, a, n) {\n      return new PipeImpl(t, function (t) {\n        return e.addReaction({\n          name: \"mapper\",\n          dataConsumer: function dataConsumer(e) {\n            return t.do.update(a(e));\n          }\n        });\n      }, n).start();\n    }\n  }, {\n    key: \"merge\",\n    value: function merge(t, e, a, n, s, r) {\n      var i = Threads.create({\n        name: \"last states\"\n      }),\n          o = Threads.create({\n        name: \"last states\"\n      }),\n          c = Threads.create({\n        name: \"last states\"\n      });\n      return new PipeImpl(t, function (t) {\n        t.addReaction({\n          name: \"append state\",\n          dataConsumer: function dataConsumer(t) {\n            return i.do.update(t);\n          }\n        }), [[e, a, o, c], [n, s, c, o]].forEach(function (e) {\n          var a = e[0],\n              n = e[1],\n              s = e[2],\n              r = e[3];\n          a.addReaction({\n            name: \"merge\",\n            dataConsumer: function dataConsumer(e) {\n              s.reducers.$update(e), t.do.update(n(e, r.getData(), i.getData()));\n            }\n          });\n        });\n      }, r).start();\n    }\n  }, {\n    key: \"tupleCombine\",\n    value: function tupleCombine(t, e, a, n) {\n      var s = Threads.create({\n        name: \"last states\"\n      }),\n          r = Threads.create({\n        name: \"last states\"\n      });\n      return new PipeImpl(\"combineArray => [\".concat(e.getName(), \", \").concat(a.getName(), \"]\"), function (n) {\n        n.addReaction({\n          name: t,\n          dataConsumer: function dataConsumer(t) {\n            s.do.update(t[0]), r.do.update(t[1]);\n          }\n        }), [[e, r, \"left\"], [a, s, \"right\"]].forEach(function (t) {\n          var e = t[0],\n              a = t[1],\n              s = t[2];\n          e.addReaction({\n            name: \"tuple=>\".concat(s),\n            dataConsumer: function dataConsumer(t) {\n              var e;\n\n              if (\"left\" === s) {\n                e = [t, a.getData()];\n              } else {\n                e = [a.getData(), t];\n              }\n\n              n.do.update(e);\n            }\n          });\n        });\n      }, n).start();\n    }\n  }, {\n    key: \"combine\",\n    value: function combine(t, e, a) {\n      return new PipeImpl(t, function (t) {\n        return Objects.foreachEntry(e, function (e, a) {\n          return e.addReaction({\n            name: \"combine\",\n            dataConsumer: function dataConsumer(e) {\n              t.reducers.$update(function (t) {\n                return Object.assign(Object.assign({}, t), _defineProperty({}, a, e));\n              });\n            }\n          });\n        });\n      }, a).start();\n    }\n  }, {\n    key: \"filter\",\n    value: function filter(t, e, a, n) {\n      var s = Threads.create({\n        name: \"last states\"\n      });\n      return new PipeImpl(t, function (t) {\n        t.addReaction({\n          name: \"save state\",\n          dataConsumer: function dataConsumer(t) {\n            return s.reducers.$update(t);\n          }\n        }), e.addReaction({\n          name: \"pipe-filter\",\n          dataConsumer: function dataConsumer(e) {\n            var n = s.getData();\n            a(e, n) && t.reducers.$update(e);\n          }\n        });\n      }, n).start();\n    }\n  }]);\n\n  return Pipes;\n}();\n\nvar ConanState = /*#__PURE__*/function () {\n  function ConanState(t) {\n    _classCallCheck(this, ConanState);\n\n    this.state = t;\n  }\n\n  _createClass(ConanState, [{\n    key: \"getName\",\n    value: function getName() {\n      return this.state.getName();\n    }\n  }, {\n    key: \"connectMap\",\n    value: function connectMap(t, e) {\n      return React.createElement(StateMapConnect, {\n        from: this,\n        into: t,\n        mapper: e\n      });\n    }\n  }, {\n    key: \"connectData\",\n    value: function connectData(t) {\n      return React.createElement(StateMapConnect, {\n        from: this,\n        into: t,\n        mapper: function mapper(t) {\n          return t;\n        }\n      });\n    }\n  }, {\n    key: \"connect\",\n    value: function connect(t) {\n      return React.createElement(StateConnect, {\n        from: this,\n        into: t\n      });\n    }\n  }, {\n    key: \"connectLive\",\n    value: function connectLive(t, e) {\n      return React.createElement(StateLive, {\n        from: this,\n        renderer: t,\n        fallbackValue: e\n      });\n    }\n  }, {\n    key: \"addAsyncReaction\",\n    value: function addAsyncReaction(t) {\n      if (!this.isThreadBased()) return this.asMonitor().addAsyncReaction(t);\n    }\n  }, {\n    key: \"addDataReaction\",\n    value: function addDataReaction(t) {\n      return this.state.addReaction(t);\n    }\n  }, {\n    key: \"start\",\n    value: function start() {\n      return this.state.start(), this;\n    }\n  }, {\n    key: \"stop\",\n    value: function stop(t) {\n      return this.state.stop(t), this;\n    }\n  }, {\n    key: \"getData\",\n    value: function getData() {\n      return this.state.getData();\n    }\n  }, {\n    key: \"asyncMerge\",\n    value: function asyncMerge(t, e, a) {\n      if (this.isThreadBased()) throw new Error(\"this conan state is not ready for async\");\n      var n = Pipes.fromMonitor(this.state, e, a, {\n        initialData: t\n      });\n      return new ConanState(new ThreadFacade(n, this.actions));\n    }\n  }, {\n    key: \"filter\",\n    value: function filter(t) {\n      var e = Pipes.filter(\"filter=>\".concat(this.getName()), this.isThreadBased() ? this.asThread() : this.asMonitor().mainThread, t);\n      return new ConanState(e);\n    }\n  }, {\n    key: \"map\",\n    value: function map(t) {\n      var e = Pipes.map(\"map=>\".concat(this.getName()), this.isThreadBased() ? this.asThread() : this.asMonitor().mainThread, t);\n      return new ConanState(e);\n    }\n  }, {\n    key: \"merge\",\n    value: function merge(t, e) {\n      var a = Pipes.merge(\"merge=>\".concat(this.getName()), this.isThreadBased() ? this.asThread() : this.asMonitor().mainThread, e, t.asThread(), function (t, a, n) {\n        return e(a, t, n);\n      });\n      return new ConanState(a);\n    }\n  }, {\n    key: \"tuple\",\n    value: function tuple(t) {\n      var e = Pipes.tupleCombine(\"mergeTuple=>\".concat(this.getName()), this.isThreadBased() ? this.asThread() : this.asMonitor().mainThread, t.asThread());\n      return new ConanState(e);\n    }\n  }, {\n    key: \"isThreadBased\",\n    value: function isThreadBased() {\n      return !this.isMonitorBased();\n    }\n  }, {\n    key: \"isMonitorBased\",\n    value: function isMonitorBased() {\n      return this.state instanceof MonitorFacade;\n    }\n  }, {\n    key: \"asThread\",\n    value: function asThread() {\n      return this.isThreadBased() ? this.state : this.asMonitor().mainThread;\n    }\n  }, {\n    key: \"asMonitor\",\n    value: function asMonitor() {\n      return this.state;\n    }\n  }, {\n    key: \"do\",\n    get: function get() {\n      return this.state.do;\n    }\n  }, {\n    key: \"actions\",\n    get: function get() {\n      return this.state.actions;\n    }\n  }], [{\n    key: \"combine\",\n    value: function combine(t, e, a) {\n      var n = Pipes.combine(t, Objects.mapKeys(e, function (t) {\n        return t.asThread();\n      }), a);\n      return new ConanState(n);\n    }\n  }]);\n\n  return ConanState;\n}();\n\nvar MonitorImpl = /*#__PURE__*/function () {\n  function MonitorImpl(t, e) {\n    _classCallCheck(this, MonitorImpl);\n\n    this.mainThread = t, this.asyncThread = e;\n  }\n\n  _createClass(MonitorImpl, [{\n    key: \"start\",\n    value: function start() {\n      return this.mainThread.start(), this;\n    }\n  }, {\n    key: \"addReaction\",\n    value: function addReaction(t) {\n      return this.mainThread.addReaction(t);\n    }\n  }, {\n    key: \"addAsyncReaction\",\n    value: function addAsyncReaction(t) {\n      return this.asyncThread.addReaction(t);\n    }\n  }, {\n    key: \"getEvents\",\n    value: function getEvents() {\n      return this.mainThread.getEvents();\n    }\n  }, {\n    key: \"getName\",\n    value: function getName() {\n      return this.mainThread.getName();\n    }\n  }, {\n    key: \"stop\",\n    value: function stop(t) {\n      this.mainThread.stop(t);\n    }\n  }, {\n    key: \"getData\",\n    value: function getData() {\n      return this.mainThread.getData();\n    }\n  }, {\n    key: \"next\",\n    value: function next(t) {\n      this.mainThread.next(t);\n    }\n  }, {\n    key: \"do\",\n    get: function get() {\n      return this.mainThread.do;\n    }\n  }]);\n\n  return MonitorImpl;\n}();\n\nvar Monitors = /*#__PURE__*/function () {\n  function Monitors() {\n    _classCallCheck(this, Monitors);\n  }\n\n  _createClass(Monitors, null, [{\n    key: \"create\",\n    value: function create(t) {\n      var e = this.createAsyncThread(t),\n          a = Threads.create(Object.assign(Object.assign({}, t), {\n        pipelineListener: function pipelineListener(t) {\n          t.runtimeEvent !== FlowRuntimeEventType.MONITOR || (t.timing === FlowRuntimeEventTiming.REQUEST_START ? e.do.tick(t.payload) : t.timing === FlowRuntimeEventTiming.REQUEST_END ? e.do.unTick(t.payload, !1) : t.timing === FlowRuntimeEventTiming.REQUEST_CANCEL && e.do.unTick(t.payload, !0));\n        }\n      })),\n          n = new MonitorImpl(a, e);\n      return new MonitorFacade(n, a.actions);\n    }\n  }, {\n    key: \"createAsyncThread\",\n    value: function createAsyncThread(t) {\n      return Threads.create({\n        name: \"monitor[\".concat(t.name, \"]\"),\n        actions: function actions(t) {\n          return {\n            tick: function tick(e) {\n              t.reducers.$update(function (t) {\n                return {\n                  status: exports.MonitorStatus.ASYNC_START,\n                  currentAction: e,\n                  inProgressActions: [].concat(_toConsumableArray(t.inProgressActions), [e])\n                };\n              });\n            },\n            unTick: function unTick(e, a) {\n              t.reducers.$update(function (t) {\n                return {\n                  status: a ? exports.MonitorStatus.ASYNC_CANCELLED : exports.MonitorStatus.ASYNC_FULFILLED,\n                  currentAction: e,\n                  inProgressActions: t.inProgressActions.filter(function (t) {\n                    return t !== e;\n                  })\n                };\n              }), 0 === t.getData().inProgressActions.length && t.reducers.$update(function (t) {\n                return {\n                  inProgressActions: [],\n                  currentAction: void 0,\n                  status: exports.MonitorStatus.IDLE\n                };\n              });\n            }\n          };\n        },\n        initialData: {\n          inProgressActions: [],\n          status: exports.MonitorStatus.IDLE,\n          currentAction: void 0\n        }\n      });\n    }\n  }]);\n\n  return Monitors;\n}();\n\nvar Conan = /*#__PURE__*/function () {\n  function Conan() {\n    _classCallCheck(this, Conan);\n  }\n\n  _createClass(Conan, null, [{\n    key: \"light\",\n    value: function light(t, e) {\n      return new ConanState(Monitors.create({\n        name: t,\n        initialData: e\n      }));\n    }\n  }, {\n    key: \"state\",\n    value: function state(t) {\n      return new ConanState(Monitors.create(t));\n    }\n  }]);\n\n  return Conan;\n}();\n\nvar Lists = /*#__PURE__*/function () {\n  function Lists() {\n    _classCallCheck(this, Lists);\n  }\n\n  _createClass(Lists, null, [{\n    key: \"mergeCombine\",\n    value: function mergeCombine(t, e, a, n) {\n      var s = [],\n          r = !1;\n      return s = e.map(function (e) {\n        var _iterator3 = _createForOfIteratorHelper(t),\n            _step3;\n\n        try {\n          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n            var _s = _step3.value;\n            if (a(_s, e)) return r = !0, n(_s, e);\n          }\n        } catch (err) {\n          _iterator3.e(err);\n        } finally {\n          _iterator3.f();\n        }\n\n        return e;\n      }), r ? s : e;\n    }\n  }]);\n\n  return Lists;\n}();\n\nexports.AsapParser = AsapParser, exports.Asaps = Asaps, exports.Conan = Conan, exports.ConanState = ConanState, exports.ContextStateConnect = ContextStateConnect, exports.ContextStateLive = ContextStateLive, exports.ContextStateMapConnect = ContextStateMapConnect, exports.DiAnnotationsMetadataFactory = DiAnnotationsMetadataFactory, exports.DiContextFactory = DiContextFactory, exports.DynamicOrStatics = DynamicOrStatics, exports.Flows = Flows, exports.InjectByName = InjectByName, exports.InjectByType = InjectByType, exports.InjectDynamic = InjectDynamic, exports.Lists = Lists, exports.ReactStateContext = ReactStateContext, exports.StateConnect = StateConnect, exports.StateLive = StateLive, exports.StateMapConnect = StateMapConnect, exports.contextStateConnect = contextStateConnect, exports.contextStateLive = contextStateLive, exports.contextStateMapConnect = contextStateMapConnect, exports.diAnnotationsCrud = diAnnotationsCrud, exports.isAsap = isAsap, exports.stateConnect = stateConnect, exports.stateLive = stateLive, exports.stateMapConnect = stateMapConnect, exports.useConanState = useConanState, exports.useContextConanState = useContextConanState, exports.useFlow = useFlow, exports.useFlowStatus = useFlowStatus;","map":{"version":3,"sources":["/Users/albertoalmansa/Projects/conan-js/tmp/conan-js-examples/composingState/node_modules/conan-js-core/dist/lib/main.min.js"],"names":["Object","defineProperty","exports","value","InjectableType","React","require","DynamicOrStatics","t","e","Strings","substring","toLowerCase","length","toUpperCase","firstCharToUpperCase","a","n","s","repeat","DiUtils","firstCharToLowerCase","name","DYNAMIC","NAME","TYPE","MetadataCrudUtils","spaceName","defaultProvider","getOrCreateMetadata","Error","getPrototype","$a","extractName","getAnnotationsMetaData","assignMetaDataToConstructor","prototype","getPrototypeOf","constructor","diAnnotationsCrud","diAnnotations","InjectByType","updateMetadata","push","onConstructorParamIndex","injectable","type","cascadeProperties","InjectDynamic","InjectByName","console","log","STRIP_COMMENTS","ARGUMENT_NAMES","Functions","toString","replace","slice","indexOf","match","DiAnnotationsMetadataFactory","beanName","extractArgNames","forEach","payload","propsProvider","dependencyName","argumentNames","diParams","DiRuntime","diInvocationResolver","diInvocationBuilderFactory","root","if","withTransitiveBeans","build","resolve","result","withProperties","r","PROPS_PROPERTY_NAME","DiInvocationResolver","diInvocationFactory","diCache","diEnricher","causesCircularDependency","circularDependencyEndOf","diMetadata","pendingDependencies","doCreate","keys","inProcessDiInvocations","invokeChildren","addValueToKeyValuePairs","addValuesToKeyValuePairs","resolveParamDef","invokeChild","resolveChildProps","resolveChildByType","resolveDynamicChild","resolveChildByName","properties","childrenOf","transitiveBeans","invoke","DiInvocationBuilderFactory","diAnnotationsMetadataFactory","DiInvocationBuilder","withInProcessDiInvocations","DiInvocationFactory","_constructor","create","KeyValueCache","cache","DiRuntimeFactory","DI_INVOCATION_RESOLVER_PROVIDER","DI_INVOCATION_BUILDER_FACTORY","cacheTBR","DiContextFactory","assign","i","IDLE","ASYNC_START","ASYNC_FULFILLED","ASYNC_CANCELLED","MonitorStatus","ReactStateContext","createContext","StateMapConnect","_isMounted","lastMonitorInfo","lastState","props","into","_mainDataReactionLock","from","addDataReaction","dataConsumer","mapper","actions","setState","state","_asyncDataReactionLock","addAsyncReaction","fallbackValue","release","createElement","Provider","Component","StateConnect","data","monitorInfo","status","stateConnect","stateMapConnect","useFlow","useEffect","reactOnStatusChanged","useFlowStatus","alwaysOn","getData","useConanState","useState","getName","children","useContextConanState","useContext","ContextStateMapConnect","Consumer","ContextStateConnect","contextStateConnect","contextStateMapConnect","ContextStateLive","renderer","StateLive","Array","isArray","Fragment","contextStateLive","stateLive","MonitorFacade","monitor","start","addReaction","getEvents","stop","next","do","asyncThread","mainThread","Objects","reduce","deepEquals","deepEqualsArrays","deepEqualsObjects","ReactionType","FlowRuntimeEventSource","FlowRuntimeEventTiming","FlowRuntimeEventType","StatusEventType","BindBackType","ONCE","ALWAYS","ThreadImpl","flow","onceOn","chainInto","map","action","deferInto","reactionType","removeReaction","getStatusData","nextData","isRunning","on","steps","StatusLikeParser","FlowRequest","flowThread","id","isStep","queuedReactions","queuedTransitions","queuedSteps","queuedStatuses","queuedStates","started","processingStatus","processStateAndReactions","flagAsSettled","onStateRequestCompleted","parse","FLOW_CONTROLLER","FLOW_THREAD","CONTEXT","FLOW_FACTORY","REQUEST_START","REQUEST_END","REQUEST_CANCEL","USER_TRACE","TRACE","INFO","MONITOR","PROCESS_REACTIONS","START","REQUEST_STATUS","FLAG_AS_SETTLED","USER_MSG","REQUEST_TRANSITION","CREATE_FLOW","FlowThread","flowController","flowOrchestrator","flowEvents","ids","createRuntimeTracker","highlight","assertValidStatus","currentRequest","trace","queueState","queueStatus","getNextId","statusRequest","transitionName","queueStep","queueTransition","transitionRequest","onTransitionRequested","getCurrentStatusName","requestTransition","requestStatus","queueReaction","addTransition","addProcessingStatus","processReactions","settleProcessingStatus","requestState","requestStep","getState","bind","transitions","chain","interruptFlow","currentStatus","getStatusDefs","join","TRANSITION","STEP","STATUS","PROCESSING_STATUS","STATE","PROCESSING_STATE","FlowEventsTracker","eventsByStatus","events","reducerName","newData","reducerPayload","fromStatus","intoStatus","transitionPayload","lastEvent","process","addStateFromStatus","allEvents","statusName","event","serializeWithStatusInfo","eventTypes","excludeInit","$init","excludeStop","$stop","statuses","FlowAnchor","currentThread","getLastStates","getLastState","methodName","Proxyfier","getOwnPropertyNames","MutatorsFactory","$update","$toStatus","createSteps","createDefaultStepsDef","createDefaultTransitionDef","doCreateTransitions","doCreateSteps","getDataFn","bindToAnchor","getStatusDataProducerFn","proxy","bindBack","$INIT","$STOP","ReactionDefLikeParser","FlowDefFactory","statusesByName","createDefaultSteps","createTransitions","reactions","$onInit","$onStop","statusesByStatusName","hasOwnProperty","starter","initialStatus","foreachEntry","getLastData","FlowRuntimeTracker","orchestrator","doTick","shortDesc","timing","onRuntimeEvent","FlowOrchestrator","eventsProcessor","pastTrackers","currentTracker","source","runtimeEvent","FlowLogger","filters","padEnd","LoggerFilters","FLOW_LOGGER","excludeByEventTiming","excludeByLogName","isPromise","then","isAsap","NowImpl","LaterImpl","NOW","LATER","AsapType","rawValue","Asaps","now","onCancel","cancel","assertOn","error","catch","AsapParser","fromPromise","Flows","createController","resolving","resolved","errored","cancelled","Promise","setTimeout","fetch","json","deferParser","FlowImpl","flowDef","flowAnchor","createNewThread","getCurrentEvents","tryToQueue","runIf","addReactionNext","getCurrentState","filter","getReactions","doRun","asap","merge","FlowFacadeImpl","onceOnInit","onceOnStop","onInit","FlowOrchestrator$","createFacade","pipelineListener","ThreadFacade","thread","reducers","MethodFinder","find","startsWith","Threads","initialData","autoBind","exists","cancelAutoStart","PipeImpl","pipeConnector","pipeThreadDef","baseThread","Pipes","update","o","c","ConanState","isThreadBased","asMonitor","fromMonitor","asThread","tupleCombine","isMonitorBased","combine","mapKeys","MonitorImpl","Monitors","createAsyncThread","tick","unTick","currentAction","inProgressActions","Conan","Lists"],"mappings":"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","sourcesContent":["\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0});var InjectableType,React=require(\"react\");class DynamicOrStatics{static result(t,e){return\"function\"==typeof t?t(e):t}}class Strings{static firstCharToLowerCase(t){return t.substring(0,1).toLowerCase()+t.substring(1,t.length)}static firstCharToUpperCase(t){return t.substring(0,1).toUpperCase()+t.substring(1,t.length)}static camelCaseWithPrefix(t,e){return t+this.firstCharToUpperCase(e)}static repeat(t,e){let a=\"\";for(let n=0;n<e;n++)a+=t;return a}static padEnd(t,e){if(null==t)return t;let a=e-t.length;if(a<1){let a=\"...\",n=1,s=n+(t.length+a.length-e);return t.substring(0,n)+a+t.substring(s,t.length)}return t+\" \".repeat(a)}}class DiUtils{static beanName(t){return Strings.firstCharToLowerCase(t.name)}}!function(t){t.DYNAMIC=\"dynamic\",t.NAME=\"name\",t.TYPE=\"type\"}(InjectableType||(InjectableType={}));class MetadataCrudUtils{constructor(t,e){this.spaceName=t,this.defaultProvider=e}updateMetadata(t,e){let a=this.getOrCreateMetadata(t);if(null==a)throw Error(\"can't get or create metaData\");return e(a),a}assignMetaDataToConstructor(t,e){let a=this.getPrototype(t);null==a.$a&&(a.$a={}),null==a.$a[this.spaceName]&&(a.$a[this.spaceName]={});let n=MetadataCrudUtils.extractName(t);a.$a[this.spaceName][n]=e}getAnnotationsMetaData(t){let e=t;e.$a||(e=this.getPrototype(t));let a=e.$a;if(null==a)return null;let n=a[this.spaceName];return null==n?null:n[MetadataCrudUtils.extractName(t)]}getOrCreateMetadata(t){if(null==this.getAnnotationsMetaData(t)){let e=this.defaultProvider();this.assignMetaDataToConstructor(t,e)}return this.getAnnotationsMetaData(t)}getPrototype(t){return\"object\"==typeof t?t:\"object\"==typeof t.prototype?t.prototype:this.getPrototype(Object.getPrototypeOf(t))}static extractName(t){let e=t.name;return null==e&&(e=t.constructor.name),e.substring(0,1).toLowerCase()+e.substring(1,e.length)}}let diAnnotationsCrud=new MetadataCrudUtils(\"$di\",()=>({diAnnotations:[]}));function InjectByType(t,e){return(a,n,s)=>{diAnnotationsCrud.updateMetadata(a,a=>a.diAnnotations.push({onConstructorParamIndex:s,injectable:t,type:InjectableType.TYPE,cascadeProperties:e}))}}function InjectDynamic(t,e){return(a,n,s)=>{diAnnotationsCrud.updateMetadata(a,a=>a.diAnnotations.push({onConstructorParamIndex:s,injectable:t,type:InjectableType.DYNAMIC,cascadeProperties:e}))}}function InjectByName(t,e){return console.log(\"Inject by name\",t),(a,n,s)=>{diAnnotationsCrud.updateMetadata(a,a=>a.diAnnotations.push({onConstructorParamIndex:s,injectable:t,type:InjectableType.NAME,cascadeProperties:e}))}}const STRIP_COMMENTS=/((\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/))/gm,ARGUMENT_NAMES=/([^\\s,]+)/g;class Functions{static extractArgNames(t){if(0===t.length)return[];let e=t.toString().replace(STRIP_COMMENTS,\"\"),a=e.slice(e.indexOf(\"(\")+1,e.indexOf(\")\")).match(ARGUMENT_NAMES);return null===a&&(a=[]),a}}class DiAnnotationsMetadataFactory{create(t){let e=DiUtils.beanName(t),a=Functions.extractArgNames(t),n={},s=diAnnotationsCrud.getAnnotationsMetaData(t);return s&&s.diAnnotations.forEach(t=>{let e=a[t.onConstructorParamIndex];n[e]={name:e,type:t.type,payload:t.injectable,propsProvider:t.cascadeProperties}}),{dependencyName:e,argumentNames:a,diParams:n,constructor:t}}}class DiRuntime{constructor(t,e){this.diInvocationResolver=t,this.diInvocationBuilderFactory=e}invoke(t,e,a){if(\"object\"==typeof t)return t;let n=this.diInvocationBuilderFactory.root(t).if(null!=e,t=>t.withTransitiveBeans(e)).build(),s=this.diInvocationResolver.resolve(n,a,this).result;if(null==s)throw Error(\"Can't invoke\");return s}invokeWithProps(t,e,a,n){let s=this.diInvocationBuilderFactory.root(t).withProperties(e).if(null!=a,t=>t.withTransitiveBeans(a)).build(),r=this.diInvocationResolver.resolve(s,n,this).result;if(null==r)throw Error(\"Can't invoke\");return r}}DiRuntime.PROPS_PROPERTY_NAME=\"$props\";class DiInvocationResolver{constructor(t,e,a){this.diInvocationFactory=t,this.diCache=e,this.diEnricher=a}resolve(t,e,a){if(this.causesCircularDependency(t))return{circularDependencyEndOf:t.diMetadata.dependencyName,result:null,pendingDependencies:{}};let n=null,s=this.diCache.resolve(t.diMetadata.dependencyName,()=>(n=this.doCreate(t,e,a),this.diEnricher&&(n.result=this.diEnricher(t.diMetadata,n.result)),Object.keys(n.pendingDependencies).indexOf(t.diMetadata.dependencyName)>-1&&n.pendingDependencies[t.diMetadata.dependencyName].forEach(e=>{this.diCache.resolve(e,null)[t.diMetadata.dependencyName]=n.result}),n.result));return null==n?{result:s,pendingDependencies:{}}:n}causesCircularDependency(t){return t.inProcessDiInvocations.indexOf(t.diMetadata.dependencyName)>-1}doCreate(t,e,a){const n=(t,e)=>{let a=t.diMetadata.constructor;return a.prototype&&a.prototype.constructor.name?e?new a(...e):new a:e?a(...e):a()};if(0===t.diMetadata.argumentNames.length){return{result:n(t,void 0),pendingDependencies:{}}}let s=[],r={};return this.invokeChildren(t,e,a).forEach(e=>{s.push(e.result),null!=e.circularDependencyEndOf&&DiInvocationResolver.addValueToKeyValuePairs(r,e.circularDependencyEndOf,t.diMetadata.dependencyName),e.pendingDependencies&&Object.keys(e.pendingDependencies).forEach(t=>{DiInvocationResolver.addValuesToKeyValuePairs(r,t,e.pendingDependencies[t])})}),{result:n(t,s),pendingDependencies:r}}static addValueToKeyValuePairs(t,e,a){t[e]||(t[e]=[]),t[e].indexOf(a)>-1||t[e].push(a)}static addValuesToKeyValuePairs(t,e,a){t[e]?a.forEach(a=>DiInvocationResolver.addValueToKeyValuePairs(t,e,a)):t[e]=a}invokeChildren(t,e,a){let n=[];return t.diMetadata.argumentNames.forEach(s=>{let r=this.resolveParamDef(t,s);n.push(this.invokeChild(t,r,e,a))}),n}resolveParamDef(t,e){let a=t.diMetadata.diParams[e];return null==a?{name:e,propsProvider:null,payload:e,type:InjectableType.NAME}:a}invokeChild(t,e,a,n){return e.name===DiRuntime.PROPS_PROPERTY_NAME?this.resolveChildProps(t):e.type===InjectableType.TYPE?this.resolveChildByType(t,e,a,n):e.type===InjectableType.DYNAMIC?this.resolveDynamicChild(t,e,a,n):this.resolveChildByName(t,e,a,n)}resolveChildProps(t){if(null==t.properties)throw Error(\"can't resolve properties for $props - There are no properties passed to the beanRuntime\");return{result:t.properties,pendingDependencies:{}}}resolveChildByType(t,e,a,n){return this.resolve(this.diInvocationFactory.childrenOf(t,e.payload,e.propsProvider),a,n)}resolveDynamicChild(t,e,a,n){return this.resolveChildByType(t,{payload:e.payload(),type:InjectableType.TYPE,propsProvider:e.propsProvider,name:e.name},a,n)}resolveChildByName(t,e,a,n){let s=e.payload;if(null==t.transitiveBeans||null==t.transitiveBeans[s]){if(null!=a[s]){return{result:n.invoke(a[s],t.transitiveBeans,a),pendingDependencies:{}}}throw Error(`can't resolve param '${s}' - There are no transitive beans passed into the runtime`)}return{result:t.transitiveBeans[s],pendingDependencies:{}}}}class DiInvocationBuilderFactory{constructor(t){this.diAnnotationsMetadataFactory=t}childrenOf(t,e,a){let n=t.inProcessDiInvocations.slice(0);return n.push(t.diMetadata.dependencyName),new DiInvocationBuilder(this.diAnnotationsMetadataFactory,e).withInProcessDiInvocations(n).withTransitiveBeans(t.transitiveBeans).if(null!=a,t=>t.withProperties(a()))}root(t){return new DiInvocationBuilder(this.diAnnotationsMetadataFactory,t)}}class DiInvocationFactory{constructor(t){this.diInvocationBuilderFactory=t}childrenOf(t,e,a){return this.diInvocationBuilderFactory.childrenOf(t,e,a).build()}}class DiInvocationBuilder{constructor(t,e){this.diAnnotationsMetadataFactory=t,this._constructor=e,this.inProcessDiInvocations=[],this.transitiveBeans={},this.properties=null}if(t,e){return t&&e(this),this}withInProcessDiInvocations(t){return this.inProcessDiInvocations=t,this}withTransitiveBeans(t){return this.transitiveBeans=t,this}withProperties(t){return this.properties=t,this}build(){return{diMetadata:this.diAnnotationsMetadataFactory.create(this._constructor),inProcessDiInvocations:this.inProcessDiInvocations,transitiveBeans:this.transitiveBeans,properties:this.properties}}}class KeyValueCache{constructor(){this.cache={}}resolve(t,e){if(this.cache[t])return this.cache[t];if(null==e)throw Error(\"Can't resolve cache\");let a=e();return this.cache[t]=a,a}}class DiRuntimeFactory{static create(t){return new DiRuntime(DiRuntimeFactory.DI_INVOCATION_RESOLVER_PROVIDER(new KeyValueCache,t||null),DiRuntimeFactory.DI_INVOCATION_BUILDER_FACTORY)}}DiRuntimeFactory.DI_INVOCATION_BUILDER_FACTORY=new DiInvocationBuilderFactory(new DiAnnotationsMetadataFactory),DiRuntimeFactory.cacheTBR=(()=>new KeyValueCache),DiRuntimeFactory.DI_INVOCATION_RESOLVER_PROVIDER=((t,e)=>new DiInvocationResolver(new DiInvocationFactory(DiRuntimeFactory.DI_INVOCATION_BUILDER_FACTORY),DiRuntimeFactory.cacheTBR(),e));class DiContextFactory{static createContext(t,e){let a,n=DiRuntimeFactory.create(),s=Object.assign(Object.assign({},t),e);a=e?[...Object.keys(t),...Object.keys(e)]:Object.keys(t);let r={},i=Object.assign(Object.assign({},t),e);return a.forEach(t=>{let e=s[t];r[t]=n.invoke(e,r,i)}),r}}!function(t){t.IDLE=\"IDLE\",t.ASYNC_START=\"ASYNC_START\",t.ASYNC_FULFILLED=\"ASYNC_FULFILLED\",t.ASYNC_CANCELLED=\"ASYNC_CANCELLED\"}(exports.MonitorStatus||(exports.MonitorStatus={}));const ReactStateContext=React.createContext(null);class StateMapConnect extends React.Component{constructor(t){super(t),this._isMounted=!1,this.lastMonitorInfo=void 0,this.lastState=void 0;let e=!0,a=this.props.into.prototype?this.props.into.prototype:this.props.into.name;this._mainDataReactionLock=this.props.from.addDataReaction({name:`connect | ${a}`,dataConsumer:t=>{this.lastState=t;let a=this.props.mapper(t,Object.assign({},this.props.from.actions),this.lastMonitorInfo);this._isMounted?this.setState(a):(e=!1,this.state=a)}}),this._asyncDataReactionLock=this.props.from.addAsyncReaction({name:`connect monitor| ${a}`,dataConsumer:t=>{this.lastMonitorInfo=t;let a=this.props.mapper(this.lastState,Object.assign({},this.props.from.actions),t);this._isMounted?this.setState(a):(e=!1,this.state=a)}}),e&&this.props.fallbackValue&&(this.state=this.props.fallbackValue(this.props.from.actions))}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1,this._mainDataReactionLock.release(),this._asyncDataReactionLock&&this._asyncDataReactionLock.release()}render(){let t=this.props.into;return React.createElement(ReactStateContext.Provider,{value:this.props.from},React.createElement(t,Object.assign({},this.state)))}}const StateConnect=t=>React.createElement(StateMapConnect,{mapper:(t,e,a)=>({data:t,actions:e,monitorInfo:a}),into:t.into,from:t.from,fallbackValue:e=>({data:t.fallbackValue,actions:e,monitorInfo:{status:exports.MonitorStatus.IDLE}})}),stateConnect=(t,e,a)=>React.createElement(StateConnect,{from:t,into:e,fallbackValue:a}),stateMapConnect=(t,e,a,n)=>React.createElement(StateMapConnect,{from:t,into:e,fallbackValue:n,mapper:a});function useFlow(t,e,a){React.useEffect(()=>{t.reactOnStatusChanged(t=>{e(e=>a?a(t,e):t.name)})},[])}function useFlowStatus(t,e,a,n){React.useEffect(()=>{t.alwaysOn(e,t=>{a(e=>n?n(t.getData(),e):t.getData())})},[])}function useConanState(t,e){let a=t.getData();const[n,s]=React.useState(null==a?e:a);return React.useEffect(()=>{const e=t.addDataReaction({dataConsumer:s,name:`useConanState[${t.getName()}]`});return()=>e.release()},[]),[n,t.actions,({children:e})=>React.createElement(ReactStateContext.Provider,{value:t},e)]}function useContextConanState(){let t=useConanState(React.useContext(ReactStateContext));return[t[0],t[1]]}class ContextStateMapConnect extends React.Component{render(){return React.createElement(ReactStateContext.Consumer,null,t=>{if(null==t)throw new Error(\"trying to access the state from the context, but it was not found, did you specify the state up in the rendering tree?\");return React.createElement(StateMapConnect,{from:t,into:this.props.into,mapper:this.props.mapper,fallbackValue:this.props.fallbackValue})})}}class ContextStateConnect extends React.Component{render(){return React.createElement(ReactStateContext.Consumer,null,t=>{if(null==t)throw new Error(\"trying to access the state from the context, but it was not found, did you specify the state up in the rendering tree?\");return React.createElement(StateConnect,{from:t,into:this.props.into,fallbackValue:this.props.fallbackValue})})}}const contextStateConnect=(t,e)=>React.createElement(ContextStateConnect,{into:t,fallbackValue:e}),contextStateMapConnect=(t,e,a)=>React.createElement(ContextStateMapConnect,{into:t,fallbackValue:a,mapper:e}),ContextStateLive=t=>{return React.createElement(ContextStateConnect,{into:e=>t.renderer(e.data,e.actions),fallbackValue:t.fallbackValue})},StateLive=t=>{return React.createElement(StateConnect,{from:t.from,into:e=>{let a=t.renderer(e.data,e.actions);return Array.isArray(a)?React.createElement(React.Fragment,null,a):a},fallbackValue:t.fallbackValue})},contextStateLive=(t,e)=>{return React.createElement(ContextStateConnect,{into:e=>{let a=t(e.data,e.actions);return Array.isArray(a)?React.createElement(React.Fragment,null,a):a},fallbackValue:e})},stateLive=(t,e,a)=>{return React.createElement(StateConnect,{from:t,into:t=>{let a=e(t.data,t.actions);return Array.isArray(a)?React.createElement(React.Fragment,null,a):a},fallbackValue:a})};class MonitorFacade{constructor(t,e){this.monitor=t,this.actions=e}start(){return this.monitor.start(),this}addAsyncReaction(t){return this.monitor.addAsyncReaction(t)}addReaction(t){return this.monitor.addReaction(t)}get do(){return this.monitor.do}getEvents(){return this.monitor.getEvents()}getName(){return this.monitor.getName()}stop(t){this.monitor.stop(t)}getData(){return this.monitor.getData()}next(t){this.monitor.next(t)}get asyncThread(){return this.monitor.asyncThread}get mainThread(){return this.monitor.mainThread}}class Objects{static mapKeys(t,e,a){let n={};return Object.keys(t).forEach(s=>{let r=a?a(s):s;n[r]=e(t[s])}),n}static foreachEntry(t,e){Object.keys(t).forEach(a=>{e(t[a],a)})}static keyfy(t,e){return t.reduce((t,a)=>Object.assign(Object.assign({},t),{[e(a)]:a}),{})}static navigate(t,e){let a=[],n=t;for(;n;)null!==(n=e(n))&&a.push(n);return a}static deepEqualsArrays(t,e){if(t.length!==e.length)return!1;for(let a of t)if(-1===e.indexOf(a))return!1;return!0}static deepEqualsObjects(t,e){for(let a of Object.keys(t))if(!Objects.deepEquals(t[a],e[a]))return!1;return!0}static deepEquals(t,e){return null==t&&null==e||(null!=t||null==e)&&((null==t||null!=e)&&(\"string\"==typeof t&&\"string\"==typeof e?t===e:\"number\"==typeof t&&\"number\"==typeof e?t===e:\"function\"==typeof t&&\"function\"==typeof e?t===e:\"boolean\"==typeof t&&\"boolean\"==typeof e?t===e:void 0===t&&void 0===e?t===e:Array.isArray(t)&&Array.isArray(e)?Objects.deepEqualsArrays(t,e):!(Array.isArray(t)&&!Array.isArray(e))&&(!(!Array.isArray(t)&&Array.isArray(e))&&(\"object\"==typeof t&&\"object\"==typeof e?Objects.deepEqualsObjects(t,e):t===e))))}}var ReactionType,FlowRuntimeEventSource,FlowRuntimeEventTiming,FlowRuntimeEventType,StatusEventType,BindBackType;!function(t){t.ONCE=\"ONCE\",t.ALWAYS=\"ALWAYS\"}(ReactionType||(ReactionType={}));class ThreadImpl{constructor(t){this.flow=t}start(t){return this.flow.start(t?{name:\"nextData\",data:t}:void 0),this}next(t){this.flow.onceOn(\"nextData\",t)}stop(t){this.flow.stop(t)}chain(t){return this.flow.chainInto(\"nextData\",\"nextData\",t).map(t=>t.getData())}monitor(t,e,a,n){let s=t.map(t=>a=>e(t,a)),r={payload:n,name:null==a?\"anonymous\":a,action:s};return this.flow.deferInto(\"nextData\",\"nextData\",r).map(t=>t.getData())}get isRunning(){return this.flow.isRunning}get reducers(){return this.flow.on(\"nextData\").steps}addReaction(t){let e={name:t.name,reactionType:ReactionType.ALWAYS,action:e=>t.dataConsumer(e.getData())};return this.flow.addReaction(\"nextData\",e),{release:()=>{this.flow.removeReaction(\"nextData\",e)}}}getData(){return this.flow.getStatusData().nextData}getEvents(){return this.flow.getEvents()}getName(){return this.flow.getName()}}class StatusLikeParser{static parse(t){return\"string\"==typeof t?{name:t}:t}}class FlowRequest{constructor(t,e,a,n){this.flowThread=t,this.id=e,this.status=a,this.isStep=n,this.queuedReactions=[],this.queuedTransitions=[],this.queuedSteps=[],this.queuedStatuses=[],this.queuedStates=[],this.started=!1,this.processingStatus={id:this.id,status:this.status}}static statusRequest(t,e,a,n){return new FlowRequest(t,e,a,n)}static transitionRequest(t,e,a,n){return new FlowRequest(t,e,StatusLikeParser.parse(a.into),n)}start(){if(this.started)throw new Error(\"unexpected\");this.started=!0,this.flowThread.processStateAndReactions(this.processingStatus,this.isStep),this.flowThread.flagAsSettled(this.processingStatus,this.isStep),this.flowThread.onStateRequestCompleted(this,this.queuedReactions,this.queuedStatuses,this.queuedStates,this.queuedTransitions,this.queuedSteps)}queueStatus(t){this.queuedStatuses.push(t)}queueTransition(t){return this.queuedTransitions.push(t),this}queueStep(t){return this.queuedSteps.push(t),this}queueState(t){this.queuedStates.push(t)}queueReaction(t,e){this.queuedReactions.push([t,e])}}!function(t){t.FLOW_CONTROLLER=\"FLOW_CONTROLLER\",t.FLOW_THREAD=\"FLOW_THREAD\",t.CONTEXT=\"CONTEXT\",t.FLOW_FACTORY=\"FLOW_FACTORY\"}(FlowRuntimeEventSource||(FlowRuntimeEventSource={})),function(t){t.REQUEST_START=\"REQUEST_START\",t.REQUEST_END=\"REQUEST_END\",t.REQUEST_CANCEL=\"REQUEST_CANCEL\",t.USER_TRACE=\"USER_TRACE\",t.TRACE=\"TRACE\",t.INFO=\"INFO\"}(FlowRuntimeEventTiming||(FlowRuntimeEventTiming={})),function(t){t.MONITOR=\"MONITOR\",t.PROCESS_REACTIONS=\"PROCESS_REACTIONS\",t.START=\"START\",t.REQUEST_STATUS=\"REQUEST_STATUS\",t.FLAG_AS_SETTLED=\"FLAG_AS_SETTLED\",t.USER_MSG=\"USER_MSG\",t.REQUEST_TRANSITION=\"REQUEST_TRANSITION\",t.CREATE_FLOW=\"CREATE_FLOW\"}(FlowRuntimeEventType||(FlowRuntimeEventType={}));class FlowThread{constructor(t,e,a){this.flowController=t,this.flowOrchestrator=e,this.flowEvents=a,this.ids={}}requestStatus(t,e){let a=StatusLikeParser.parse(t),n=this.flowOrchestrator.createRuntimeTracker(this.flowController,FlowRuntimeEventSource.FLOW_THREAD,FlowRuntimeEventType.REQUEST_STATUS,t).highlight(FlowRuntimeEventTiming.REQUEST_START,`${a.name}`);if(this.assertValidStatus(a.name),null!=this.currentRequest)return void(e?(n.trace(FlowRuntimeEventTiming.TRACE,`queueing state [${a.name}]`),this.currentRequest.queueState(a)):(n.trace(FlowRuntimeEventTiming.TRACE,`queueing status [${a.name}]`),this.currentRequest.queueStatus(a)));let s=this.getNextId(a);this.currentRequest=FlowRequest.statusRequest(this,s+\"\",a,e),this.currentRequest.start(),n.trace(FlowRuntimeEventTiming.REQUEST_END)}requestTransition(t,e){let a=StatusLikeParser.parse(t.into).name,n=this.flowOrchestrator.createRuntimeTracker(this.flowController,FlowRuntimeEventSource.FLOW_THREAD,FlowRuntimeEventType.REQUEST_TRANSITION,t).highlight(FlowRuntimeEventTiming.REQUEST_START,`${t.transitionName}`);if(n.highlight(FlowRuntimeEventTiming.INFO,e?\"step\":\"Transition\",t.transitionName),this.assertValidStatus(a),null!=this.currentRequest)return void(e?(n.trace(FlowRuntimeEventTiming.TRACE,`queueing step [${t.transitionName}]`),this.currentRequest.queueStep(t)):(n.trace(FlowRuntimeEventTiming.TRACE,`queueing transition [${t.transitionName}]`),this.currentRequest.queueTransition(t)));let s=this.getNextId(StatusLikeParser.parse(t.into));this.currentRequest=FlowRequest.transitionRequest(this,s+\"\",t,e),this.onTransitionRequested(t,e),this.currentRequest.start(),n.trace(FlowRuntimeEventTiming.REQUEST_END)}requestStep(t,e,a,n){this.assertValidStatus(t);let s=this.getCurrentStatusName();if(s!==t)throw new Error(`car't request step on [${t}] as the current status is[${s}]`);this.requestTransition({transitionName:e,payload:a,into:{name:t,data:n}},!0)}requestState(t,e){this.assertValidStatus(t);let a=this.getCurrentStatusName();if(a!==t)throw new Error(`car't request state on [${t}] as the current status is[${a}]`);this.requestStatus({name:t,data:e},!0)}tryToQueue(t,e){return null!=this.currentRequest&&(this.currentRequest.queueReaction(t,e),!0)}onTransitionRequested(t,e){this.flowEvents.addTransition(t,e)}getNextId(t,e=!1){null==this.ids[t.name]&&(this.ids[t.name]=0);let a=this.ids[t.name]+1;return e?a:(this.ids[t.name]=a,this.ids[t.name])}processStateAndReactions(t,e){this.flowEvents.addProcessingStatus(t,e),this.flowController.processReactions(t.status.name)}flagAsSettled(t,e){let a=this.flowOrchestrator.createRuntimeTracker(this.flowController,FlowRuntimeEventSource.FLOW_THREAD,FlowRuntimeEventType.FLAG_AS_SETTLED,t).highlight(FlowRuntimeEventTiming.REQUEST_START,`${t.status.name}`);this.flowEvents.settleProcessingStatus(t,e),e?a.highlight(FlowRuntimeEventTiming.INFO,\"STATE\",t.status.data):a.highlight(FlowRuntimeEventTiming.INFO,\"STATUS\",t.status),a.trace(FlowRuntimeEventTiming.REQUEST_END)}onStateRequestCompleted(t,e,a,n,s,r){if(null==this.currentRequest)throw new Error(`can't complete the request for [${this.flowController.getName()} - ${t.status.name}] as is not flagged as currently in process`);if(this.currentRequest!=t)throw new Error(`can't complete the request for [${this.flowController.getName()} - ${t.status.name}] as it does not match [${this.currentRequest.status.name}]`);if(s.length>0&&a.length>0)throw new Error(\"can't have transitions and states forked at the same time!\");if(this.currentRequest=void 0,s.length>1||a.length>1)throw new Error(\"TBI\");s.forEach(t=>this.flowController.requestTransition(t)),a.forEach(t=>this.flowController.requestStatus(t)),n.forEach(t=>this.flowController.requestState(t.name,t.data)),r.forEach(t=>{let e=StatusLikeParser.parse(t.into);this.flowController.requestStep(e.name,t.transitionName,t.payload,e.data)}),e.forEach(t=>this.flowController.addReaction(t[0],t[1]))}createContext(t,e){let a=StatusLikeParser.parse(t);return{getData:this.flowController.getState.bind(this.flowController),getStatusData:this.flowController.getStatusData.bind(this.flowController),do:Object.assign(Object.assign({},this.flowController.on(a.name).transitions),this.flowController.on(a.name).steps),chain(t){e(t)},interruptFlow:()=>{this.flowController.stop()},trace:t=>{let e=this.flowOrchestrator.createRuntimeTracker(this.flowController,FlowRuntimeEventSource.CONTEXT,FlowRuntimeEventType.USER_MSG,t).highlight(FlowRuntimeEventTiming.REQUEST_START,`${t}`),a=e.highlight(FlowRuntimeEventTiming.USER_TRACE,void 0,t);return e.trace(FlowRuntimeEventTiming.REQUEST_END),a}}}getCurrentStatusName(){let t=this.flowEvents.currentStatus;return null==t?void 0:t.name}getCurrentState(){let t=this.flowEvents.currentStatus;return null==t?void 0:t.data}assertValidStatus(t){if(null==this.flowController.on(t))throw new Error(`error requesting a transition into [${t}] unknown status, valid statuses are: [${Object.keys(this.flowController.getStatusDefs()).join(\", \")}]`)}}!function(t){t.TRANSITION=\"TRANSITION\",t.STEP=\"STEP\",t.STATUS=\"STATUS\",t.PROCESSING_STATUS=\"PROCESSING_STATUS\",t.STATE=\"STATE\",t.PROCESSING_STATE=\"PROCESSING_STATE\"}(StatusEventType||(StatusEventType={}));class FlowEventsTracker{constructor(){this.eventsByStatus={},this.events=[]}addTransition(t,e){let a,n=StatusLikeParser.parse(t.into);a=e?{type:StatusEventType.STEP,reducerName:t.transitionName,newData:n.data,reducerPayload:t.payload}:{type:StatusEventType.TRANSITION,fromStatus:this.currentStatus.name,intoStatus:n,transitionName:t.transitionName,transitionPayload:t.payload},this.lastEvent=a,this.process(a)}addStateFromStatus(t){this.lastEvent=t,this.process(t)}addProcessingStatus(t,e){let a;a=e?{type:StatusEventType.PROCESSING_STATE,data:t.status.data}:{type:StatusEventType.PROCESSING_STATUS,status:t.status},this.currentStatus=t.status,this.lastEvent=a,this.process(a)}settleProcessingStatus(t,e){if(e){if(this.lastEvent.data!==t.status.data)throw new Error(\"unexpected error settling events\");this.lastEvent.type=StatusEventType.STATE,this.eventsByStatus[this.currentStatus.name].lastState=t.status.data}else{if(this.lastEvent.status!==t.status)throw new Error(\"unexpected error settling events\");this.lastEvent.type=StatusEventType.STATUS,this.addStateFromStatus({data:t.status.data,type:StatusEventType.STATE})}}process(t){null==this.eventsByStatus[this.currentStatus.name]&&(this.eventsByStatus[this.currentStatus.name]={allEvents:[],statusName:this.currentStatus.name,lastState:void 0});let e={event:t,statusName:this.currentStatus.name};this.eventsByStatus[this.currentStatus.name].allEvents.push(e),t.type!==StatusEventType.STATE&&t.type!==StatusEventType.PROCESSING_STATE||(this.eventsByStatus[this.currentStatus.name].lastState=t.data),this.events.push(e)}serializeStatesWithStatus(t){return this.serializeWithStatusInfo(Object.assign(Object.assign({},t),{eventTypes:[StatusEventType.STATE]}))}serializeStates(t){return this.serializeWithStatusInfo(Object.assign(Object.assign({},t),{eventTypes:[StatusEventType.STATE]})).map(t=>t.event)}serializeStatuses(t){return this.serializeWithStatusInfo(Object.assign(Object.assign({},t),{eventTypes:[StatusEventType.STATUS]})).map(t=>t.event)}serialize(t){return this.serializeWithStatusInfo(t).map(t=>t.event)}serializeWithStatusInfo(t){if(!t)return this.events;let e=[];return this.events.forEach(a=>{let n=!0;n&&(t.excludeInit&&this.eventsByStatus.$init.allEvents.indexOf(a)>-1&&(n=!1),n&&(t.excludeStop&&this.eventsByStatus.$stop&&this.eventsByStatus.$stop.allEvents.indexOf(a)>-1&&(n=!1),n&&(t.statuses&&t.statuses.forEach(t=>{n||-1===this.eventsByStatus[t].allEvents.indexOf(a)&&(n=!1)}),n&&(t.eventTypes&&-1===t.eventTypes.indexOf(a.event.type)&&(n=!1),n&&e.push(a)))))}),e}getLastStates(){let t={};return Object.keys(this.eventsByStatus).forEach(e=>{t[e]=this.eventsByStatus[e].lastState}),t}getLastState(t){let e=this.eventsByStatus[t];if(null!=e)return e.lastState}}!function(t){t.STEP=\"STEP\",t.TRANSITION=\"TRANSITION\"}(BindBackType||(BindBackType={}));class FlowAnchor{createNewThread(t,e){let a=new FlowEventsTracker,n=new FlowThread(t,e,a);return this.currentThread={flowEvents:a,flowThread:n},n}getCurrentEvents(){return this.currentThread.flowEvents}get currentStatus(){if(this.currentThread)return this.currentThread.flowEvents.currentStatus}getStatusDataProducerFn(){return(t,e)=>{let a=this.currentThread.flowEvents.getLastStates();return-1===Object.keys(a).indexOf(t)?e:a[t]}}getDataFn(t){return()=>{if(null==this.currentThread)throw new Error(\"error getting the data function associated to this flow, this might happen if you try to mutate the state of the flow before it has been started.\");let e=this.currentThread.flowEvents.currentStatus.name;if(\"$init\"!==e){if(t!==e)throw new Error(`unexpected error trying to retrieve the last status for [${t}, but the current status is [${e}]]`);return this.currentThread.flowEvents.getLastState(t)}}}bindBack(t,e,a){if(!this.currentThread.flowThread.flowController.isRunning)return;let n=e.result&&\"$stop\"!=e.result.name,s=this.currentStatus&&\"$init\"!=this.currentStatus.name;if(n&&s&&(!this.currentStatus||this.currentStatus.name!==t))throw Error(`unable to request [${e.methodName}] as is meant for status [${t}], but the current status is [${this.currentStatus?this.currentStatus.name:\"-\"}]`);if(a===BindBackType.STEP){\"$init\"===this.currentThread.flowThread.getCurrentStatusName()?this.currentThread.flowThread.requestTransition({into:{name:t,data:e.result},payload:e.payload,transitionName:e.methodName},!1):this.currentThread.flowThread.requestStep(e.statusName,e.methodName,e.payload,e.result)}else this.currentThread.flowThread.requestTransition({into:e.result,payload:e.payload,transitionName:e.methodName},!1)}getStatusData(){return this.currentThread.flowEvents.getLastStates()}}class Proxyfier{static proxy(t,e){let a={},n=Object.getPrototypeOf(t),s=\"Object\"===n.constructor.name?t:n;return Object.getOwnPropertyNames(s).forEach(n=>{if(\"constructor\"===n)return;\"function\"==typeof s[n]&&(a[n]=((...a)=>{return e(()=>{return t[n](...a)},{methodName:n,payload:a})}))}),a}}class MutatorsFactory{static createDefaultStepsDef(){return t=>({$update:e=>\"function\"!=typeof e?e:e(t())})}static createDefaultTransitionDef(){return()=>({$toStatus:t=>StatusLikeParser.parse(t)})}static createDefaultSteps(t,e){return this.createSteps(t,e,this.createDefaultStepsDef())}static createTransitions(t,e,a){let n=this.createDefaultTransitionDef();return this.doCreateTransitions(t,e,a?[a,n]:[n])}static createSteps(t,e,a){let n=this.createDefaultStepsDef();return this.doCreateSteps(t,e,a?[a,n]:[n])}static doCreateSteps(t,e,a){let n=e.getDataFn(t),s={};return a.forEach(t=>{let e=t(n);s=Object.assign(Object.assign({},s),e)}),this.bindToAnchor(t,e,s,BindBackType.STEP)}static doCreateTransitions(t,e,a){let n=e.getStatusDataProducerFn(),s={};return a.forEach(t=>{let e=t(n);s=Object.assign(Object.assign({},s),e)}),this.bindToAnchor(t,e,s,BindBackType.TRANSITION)}static bindToAnchor(t,e,a,n){return Proxyfier.proxy(a,(a,s)=>{let r=a();return e.bindBack(t,{statusName:e.currentStatus.name,methodName:s.methodName,payload:s.payload,result:r},n),r})}}const $INIT=\"$init\",$STOP=\"$stop\";class ReactionDefLikeParser{static parse(t,e,a){return\"object\"==typeof t?t:{name:a||\"anonymous\",reactionType:e,action:t}}}class FlowDefFactory{static create(t,e){let a=FlowDefFactory.statusesByName(t.statuses,e);return a[$INIT]={name:$INIT,steps:MutatorsFactory.createDefaultSteps($INIT,e),transitions:MutatorsFactory.createTransitions($INIT,e),reactions:t.$onInit?t.$onInit.map(t=>ReactionDefLikeParser.parse(t,ReactionType.ALWAYS,\"on init\")):[]},a[$STOP]={name:$STOP,steps:MutatorsFactory.createDefaultSteps($STOP,e),transitions:MutatorsFactory.createTransitions($STOP,e),reactions:t.$onStop?t.$onStop.map(t=>ReactionDefLikeParser.parse(t,ReactionType.ALWAYS,\"on stop\")):[]},Object.assign({statusesByStatusName:a,name:t.name},t.hasOwnProperty(\"initialStatus\")?{starter:()=>t.initialStatus}:void 0)}static statusesByName(t,e){let a={};return Array.isArray(t)?t.forEach(t=>{a[t]={name:t,steps:[],reactions:[]}}):Objects.foreachEntry(t,(t,n)=>{a[n]={name:n,steps:MutatorsFactory.createSteps(n,e,t.steps),transitions:MutatorsFactory.createTransitions(n,e,t.transitions),reactions:t.reactions?t.reactions.map(t=>ReactionDefLikeParser.parse(t,ReactionType.ALWAYS,`on[${n}]`)):[],getLastData:e.getDataFn(n)}}),a}}class FlowRuntimeTracker{constructor(t,e){this.orchestrator=t,this.event=e}trace(t,e,a){return this.doTick(t,e,a,{highlight:!1})}highlight(t,e,a){return this.doTick(t,e,a,{highlight:!0})}doTick(t,e,a,n){let s=Object.assign(Object.assign(Object.assign({},this.event),{shortDesc:e,timing:t}),a?{payload:a}:void 0);return this.orchestrator.onRuntimeEvent(this,s,n),this}}class FlowOrchestrator{constructor(t){this.eventsProcessor=t,this.pastTrackers=[]}onRuntimeEvent(t,e,a){e.timing===FlowRuntimeEventTiming.REQUEST_START?this.currentTracker=t:e.timing!==FlowRuntimeEventTiming.REQUEST_END&&e.timing!==FlowRuntimeEventTiming.REQUEST_CANCEL||(this.pastTrackers.push(t),this.currentTracker=void 0),this.eventsProcessor.forEach(t=>t(e,a))}createRuntimeTracker(t,e,a,n){return new FlowRuntimeTracker(this,{flowController:t,source:e,runtimeEvent:a,payload:n})}}class FlowLogger{constructor(t){this.filters=t}log(t,e){for(let e of this.filters)if(!e(t))return;let a=t.flowController.getCurrentStatusName();a=a||\"-\",e.highlight?(console.log(Strings.padEnd(`${t.flowController.getName()}`,30),Strings.padEnd(`${a}`,20),Strings.padEnd(`${t.runtimeEvent}`,20),Strings.padEnd(`${t.timing}`,20)),(t.payload||t.shortDesc)&&(t.shortDesc?(console.log(`  =>[${t.shortDesc}]`),t.payload&&console.log(\" \",t.payload)):console.log(`  =>[${t.payload}]`)),console.log(\"------------------------------------------------------------------------------------------------------------------------------------------------\")):t.shortDesc&&console.log(Strings.padEnd(`${t.flowController.getName()}`,30),Strings.padEnd(`${a}`,20),Strings.padEnd(`${t.runtimeEvent}`,20),Strings.padEnd(`${t.timing}`,20),Strings.padEnd(`=>${t.shortDesc}`,30))}}class LoggerFilters{static excludeByLogName(t){return e=>e.flowController.getName()!==t}static excludeByEventTiming(t){return e=>e.timing!==t}}const FLOW_LOGGER=new FlowLogger([LoggerFilters.excludeByEventTiming(FlowRuntimeEventTiming.REQUEST_END),LoggerFilters.excludeByEventTiming(FlowRuntimeEventTiming.REQUEST_START),LoggerFilters.excludeByLogName(\"next-promise\")]);function isPromise(t){return null!=t&&(\"object\"==typeof t&&(\"then\"in t&&\"function\"==typeof t.then))}function isAsap(t){return t instanceof NowImpl||t instanceof LaterImpl}!function(t){t.NOW=\"NOW\",t.LATER=\"LATER\"}(exports.AsapType||(exports.AsapType={}));class NowImpl{constructor(t){this.rawValue=t,this.type=exports.AsapType.NOW}cancel(){return!1}then(t){return t(this.rawValue),this}map(t){return Asaps.now(t(this.rawValue))}merge(t){const[e,a]=Asaps.next();return this.then(a=>t(a).then(t=>e(t))),a}catch(t){return this}onCancel(t){return this}}class LaterImpl{constructor(t){this.flow=t,this.type=exports.AsapType.LATER}map(t){let[e,a]=Asaps.next();return this.then(a=>e(t(a))),this.onCancel(()=>a.cancel()),a}then(t){return\"resolved\"===this.flow.getCurrentStatusName()?t(this.flow.on(\"resolved\").getLastData()):this.flow.on(\"resolving\").steps.$update(e=>Object.assign(Object.assign({},e),{then:[...e.then,t]})),this}resolve(t){if(\"cancelled\"!==this.flow.getCurrentStatusName())try{this.flow.assertOn(\"resolving\",e=>{e.getData().then.forEach(e=>{e(t)}),this.flow.on(\"resolving\").transitions.$toStatus({name:\"resolved\",data:t})})}catch(e){console.error(e),this.flow.assertOn(\"resolving\",a=>{a.getData().catch.forEach(a=>{a(e,t)}),a.do.$toStatus({name:\"errored\",data:t})})}}onCancel(t){if(\"cancelled\"!==this.flow.getCurrentStatusName())return\"resolving\"===this.flow.getCurrentStatusName()&&this.flow.on(\"resolving\").steps.$update(e=>Object.assign(Object.assign({},e),{onCancel:[...e.onCancel,t]})),this;t()}cancel(){return\"resolving\"===this.flow.getCurrentStatusName()&&(this.flow.assertOn(\"resolving\",t=>{t.getData().onCancel.forEach(t=>{t()}),this.flow.on(\"resolving\").transitions.$toStatus({name:\"cancelled\"})}),!0)}merge(t){const[e,a]=Asaps.next();return this.then(n=>t(n).then(t=>e(t)).onCancel(()=>a.cancel())).onCancel(()=>a.cancel()),a}catch(t){return\"resolving\"===this.flow.getCurrentStatusName()&&this.flow.on(\"resolving\").steps.$update(e=>Object.assign(Object.assign({},e),{catch:[...e.catch,t]})),this}}class AsapParser{static from(t){return isAsap(t)?t:isPromise(t)?Asaps.fromPromise(t):Asaps.now(t)}}class Asaps{static now(t){return new NowImpl(t)}static fromPromise(t){let e=new LaterImpl(Flows.createController({name:\"next-promise\",statuses:{resolving:{},resolved:{},errored:{},cancelled:{}},initialStatus:{name:\"resolving\",data:{then:[],catch:[],onCancel:[]}}}).start());return t.then(t=>e.resolve(t)),t.catch(t=>e.catch(t)),e}static delayed(t,e){return Asaps.fromPromise(new Promise(a=>setTimeout(()=>a(t),e)))}static fetch(t){return Asaps.fromPromise(new Promise(e=>{fetch(t).then(t=>t.json()).then(function(t){e(t)})}))}static next(){let t=new LaterImpl(Flows.createController({name:\"next-promise\",statuses:{resolving:{},resolved:{},errored:{},cancelled:{}},initialStatus:{name:\"resolving\",data:{then:[],catch:[],onCancel:[]}}}).start());return[e=>t.resolve(e),t]}}function deferParser(t,e){return isAsap(t)?{action:t,name:e.name,payload:e.payload}:t}class FlowImpl{constructor(t,e,a){this.flowDef=t,this.flowAnchor=e,this.flowOrchestrator=a,this.isRunning=!1}start(t){let e=this.flowOrchestrator.createRuntimeTracker(this,FlowRuntimeEventSource.FLOW_CONTROLLER,FlowRuntimeEventType.START,t).trace(FlowRuntimeEventTiming.REQUEST_START);if(this.isRunning)throw new Error(\"can't request a flow that it has been started to start again\");if(this.flowThread=this.flowAnchor.createNewThread(this,this.flowOrchestrator),this.isRunning=!0,null==t&&null==this.flowDef.starter)return this.requestStatus($INIT),this;let a=t||this.flowDef.starter(),n=t=>{this.addReaction($INIT,{action:()=>{e.highlight(FlowRuntimeEventTiming.TRACE,\"initialStatus - resolved\",t),this.requestStatus(t)},reactionType:ReactionType.ONCE,name:\"to initial state\"}),this.addReaction($STOP,{name:\"onStop=>notifyEvents\",reactionType:ReactionType.ONCE,action:t=>{t.chain(()=>{e.highlight(FlowRuntimeEventTiming.TRACE,\"state machine stopped\"),this.flowThread=null,this.isRunning=!1})}}),this.requestStatus($INIT)};return AsapParser.from(a).then(t=>n(t)),e.trace(FlowRuntimeEventTiming.REQUEST_END),this}requestStatus(t){let e=StatusLikeParser.parse(t).name;if(this.isRunning){if(null==this.on(e))throw new Error(`unable to request non existing status [${e}]`);this.flowThread.requestStatus(t,!1)}}requestState(t,e){this.isRunning&&this.flowThread.requestState(t,e)}requestTransition(t){if(this.isRunning)return this.flowThread.requestTransition(t,!1),this}requestStep(t,e,a,n){this.isRunning&&this.flowThread.requestStep(t,e,a,n)}stop(t){if(!this.isRunning)throw new Error(\"unexpected\");return this.addReaction($STOP,{name:\"onStop=>notifyEvents\",reactionType:ReactionType.ONCE,action:()=>{t&&t(this.flowAnchor.getCurrentEvents())}}),this.requestStatus({name:$STOP}),this}alwaysOn(t,e){return this.addReaction(t,{name:\"-\",reactionType:ReactionType.ALWAYS,action:e})}onceOnInit(t){return this.onceOn($INIT,t)}onceOnStop(t){return this.onceOn($STOP,t)}onceOn(t,e){return this.addReaction(t,{name:\"-\",reactionType:ReactionType.ONCE,action:e})}addReaction(t,e){let a=!0;if(this.isRunning){if(this.flowThread.tryToQueue(t,e))return this;this.runIf(t,{action:t=>{e.action(t),e.reactionType===ReactionType.ONCE&&(a=!1)},reactionType:e.reactionType,name:e.name})}if(a){let a=this.on(t);if(null==a)throw new Error(`unable to add reactions for unknown event [${t}]`);this.addReactionNext(a,e)}return this}addReactionNext(t,e){return t.reactions.push(e),this}getReactions(t){let e=this.on(t);if(null==e)throw new Error(`can't getReactions for unknown status[${t}]`);return e.reactions}getCurrentStatusName(){if(void 0!=this.flowThread)return this.flowThread.getCurrentStatusName()}getEvents(){return this.flowAnchor.getCurrentEvents()}getName(){return this.flowDef.name}getState(){return this.flowThread.getCurrentState()}getStatusData(){return this.flowAnchor.getStatusData()}onInit(){return this.on($INIT)}on(t){return this.flowDef.statusesByStatusName[t]}getStatusDefs(){return this.flowDef.statusesByStatusName}removeReaction(t,e){let a=this.on(t),n=a.reactions;n&&(a.reactions=n.filter(t=>t!==e))}processReactions(t){let e,a=this.flowOrchestrator.createRuntimeTracker(this,FlowRuntimeEventSource.FLOW_CONTROLLER,FlowRuntimeEventType.PROCESS_REACTIONS,t).trace(FlowRuntimeEventTiming.REQUEST_START);return this.getReactions(t).forEach(a=>{a.reactionType===ReactionType.ONCE&&this.removeReaction(t,a),a.action(this.flowThread.createContext(t,t=>e=t))}),e&&e(),a.trace(FlowRuntimeEventTiming.REQUEST_END,t),this}getStateData(){throw new Error(\"TBI\")}reactOnStatusChanged(t){return Object.keys(this.getStatusDefs()).forEach(e=>{this.addReaction(e,{name:\"-\",reactionType:ReactionType.ALWAYS,action:a=>t({name:e,data:a.getData()})})}),this}runIf(t,e,a){if(!this.isRunning)return void(a&&a());let n=this.getCurrentStatusName();null!=n&&n===t?this.doRun(e,t):a&&a()}doRun(t,e){t.action(this.flowThread.createContext(e,t=>t()))}assertOn(t,e){let a=this.getCurrentStatusName();if(a!==t)throw new Error(`asserting that we are on the status [${t}]. But we are currently on [${a}]`);return e&&this.onceOn(t,t=>e(t)),this}chainInto(t,e,a){const[n,s]=Asaps.next();if(\"$init\"!==this.getCurrentStatusName())this.assertOn(t),this.addReactionNext(this.on(e),{name:\"once on next\",reactionType:ReactionType.ONCE,action:t=>n(t)}),this.onceOn(t,t=>a(t.do));else{let t=this.getStatusDefs()[e];this.onceOn(\"$init\",()=>a(t.steps))}return s}deferInto(t,e,a){let n=deferParser(a,{name:`[${this.getName()}]::${t}=>${e}`,payload:`[${this.getName()}]::${t}=>${e}`}),s=this.flowOrchestrator.createRuntimeTracker(this,FlowRuntimeEventSource.FLOW_CONTROLLER,FlowRuntimeEventType.MONITOR,{asap:n.action,name:n.name,payload:n.payload}).trace(FlowRuntimeEventTiming.REQUEST_START);return n.action.merge(a=>(s.trace(FlowRuntimeEventTiming.REQUEST_END),this.chainInto(t,e,a))).onCancel(()=>{s.trace(FlowRuntimeEventTiming.REQUEST_CANCEL)})}}class FlowFacadeImpl{constructor(t,e){this.flow=t,this.actions=e,this.do=e}addReaction(t,e){return this.flow.addReaction(t,e),this}alwaysOn(t,e){return this.flow.alwaysOn(t,e),this}assertOn(t,e){return this.flow.assertOn(t,e),this}chainInto(t,e,a){this.flow.chainInto(t,e,a)}getCurrentStatusName(){return this.flow.getCurrentStatusName()}getEvents(){return this.flow.getEvents()}getName(){return this.flow.getName()}getState(){return this.flow.getState()}getStatusData(){return this.flow.getStatusData()}on(t){return this.flow.on(t)}onceOn(t,e){return this.flow.onceOn(t,e),this}onceOnInit(t){return this.flow.onceOnInit(t),this}onceOnStop(t){return this.flow.onceOnStop(t),this}start(t){return this.flow.start(t),this}stop(t){return this.flow.stop(t),this}get isRunning(){return this.flow.isRunning}onInit(){return this.flow.onInit()}reactOnStatusChanged(t){return this.flow.reactOnStatusChanged(t),this}deferInto(t,e,a){return this.flow.deferInto(t,e,a)}removeReaction(t,e){this.flow.removeReaction(t,e)}}const FlowOrchestrator$=t=>new FlowOrchestrator([(t,e)=>FLOW_LOGGER.log(t,e),...t]);class Flows{static create(t){let e=this.createController(t);return this.createFacade(e,t.actions)}static createFacade(t,e){return new FlowFacadeImpl(t,e?e(t):void 0)}static createController(t){let e=new FlowAnchor,a=FlowOrchestrator$(t.pipelineListener?[t.pipelineListener]:[]),n=new FlowImpl(FlowDefFactory.create(t,e),e,a);return a.createRuntimeTracker(n,FlowRuntimeEventSource.FLOW_FACTORY,FlowRuntimeEventType.CREATE_FLOW,t).trace(FlowRuntimeEventTiming.REQUEST_START).trace(FlowRuntimeEventTiming.REQUEST_END,n),n}}class ThreadFacade{constructor(t,e){this.thread=t,this.actions=e}chain(t){this.thread.chain(t)}next(t){this.thread.next(t)}start(){return this.thread.start(),this}stop(t){return this.thread.stop(t),this}get do(){let t=this.reducers;return Object.assign(Object.assign({},t),this.actions)}get reducers(){return this.thread.reducers}addReaction(t){return this.thread.addReaction(t)}get isRunning(){return this.thread.isRunning}getData(){return this.thread.getData()}getEvents(){return this.thread.getEvents()}getName(){return this.thread.getName()}}class MethodFinder{static exists(t,e){return null!=t&&this.find(t,e).length>0}static find(t,e=\"\"){let a=Object.getPrototypeOf(t),n=\"Object\"===a.constructor.name?t:a;return Object.getOwnPropertyNames(n).filter(t=>t.startsWith(e))}}class Threads{static create(t){let e,a=Flows.createController(Object.assign(Object.assign({name:t.name,statuses:{nextData:Object.assign(Object.assign({},t.reducers?{steps:t.reducers}:void 0),t.reactions?{reactions:t.reactions}:void 0)}},t.hasOwnProperty(\"initialData\")?{initialStatus:AsapParser.from(t.initialData).map(t=>({name:\"nextData\",data:t}))}:void 0),{pipelineListener:t.pipelineListener})),n=new ThreadImpl(a);if(t.actions&&t.autoBind)throw new Error(\"you can only use actions or autoBind. Both in conjunction is illegal\");if(t.autoBind){let a=[],s=Object.assign({},t.autoBind);Object.keys(n.reducers).forEach(e=>{let r=e.substring(1,e.length);MethodFinder.exists(t.autoBind,r)?(s[r]=((...e)=>t.autoBind[r](...e)),a.push(r)):s[r]=((...t)=>n.chain(a=>a[e](...t)))}),e=new ThreadFacade(n,Proxyfier.proxy(s,(t,e)=>-1===a.indexOf(e.methodName)?t():n.monitor(t(),(t,a)=>a[`$${e.methodName}`](t),e.methodName,e.payload)))}else{let a=t.actions?t.actions(n):{};Object.keys(n.reducers).forEach(t=>{let e=t.substring(1,t.length);a[e]||(a[e]=((...e)=>n.chain(a=>a[t](...e))))}),e=new ThreadFacade(n,a)}return t.cancelAutoStart||e.start(),e}}class PipeImpl{constructor(t,e,a){this.name=t,this.pipeConnector=e,this.pipeThreadDef=a}addReaction(t){return this.baseThread.addReaction(t)}chain(t){return this.baseThread.chain(t)}getData(){return this.baseThread.getData()}getEvents(){return this.baseThread.getEvents()}getName(){return this.baseThread.getName()}next(t){this.baseThread.next(t)}start(){if(null==this.baseThread){let t=Object.assign({name:this.name},this.pipeThreadDef);this.baseThread=Threads.create(t),this.pipeConnector(this.baseThread)}else this.baseThread.start();return this}stop(t){return this.baseThread.stop(void 0),this}get reducers(){return this.baseThread.reducers}get isRunning(){return this.baseThread.isRunning}get do(){return this.baseThread.do}get actions(){return this.baseThread.actions}get thread(){return this.baseThread.thread}}class Pipes{static fromMonitor(t,e,a,n){return Pipes.filter(\"unique-monitor\",Pipes.merge(`pipeMonitor=>raw[${t.getName()}]`,t.asyncThread,e,t.mainThread,a,n),(t,e)=>!Objects.deepEquals(t,e))}static map(t,e,a,n){return new PipeImpl(t,t=>e.addReaction({name:\"mapper\",dataConsumer:e=>t.do.update(a(e))}),n).start()}static merge(t,e,a,n,s,r){let i=Threads.create({name:\"last states\"}),o=Threads.create({name:\"last states\"}),c=Threads.create({name:\"last states\"});return new PipeImpl(t,t=>{t.addReaction({name:\"append state\",dataConsumer:t=>i.do.update(t)}),[[e,a,o,c],[n,s,c,o]].forEach(e=>{let a=e[0],n=e[1],s=e[2],r=e[3];a.addReaction({name:\"merge\",dataConsumer:e=>{s.reducers.$update(e),t.do.update(n(e,r.getData(),i.getData()))}})})},r).start()}static tupleCombine(t,e,a,n){let s=Threads.create({name:\"last states\"}),r=Threads.create({name:\"last states\"});return new PipeImpl(`combineArray => [${e.getName()}, ${a.getName()}]`,n=>{n.addReaction({name:t,dataConsumer:t=>{s.do.update(t[0]),r.do.update(t[1])}}),[[e,r,\"left\"],[a,s,\"right\"]].forEach(t=>{let e=t[0],a=t[1],s=t[2];e.addReaction({name:`tuple=>${s}`,dataConsumer:t=>{let e;if(\"left\"===s){e=[t,a.getData()]}else{e=[a.getData(),t]}n.do.update(e)}})})},n).start()}static combine(t,e,a){return new PipeImpl(t,t=>Objects.foreachEntry(e,(e,a)=>e.addReaction({name:\"combine\",dataConsumer:e=>{t.reducers.$update(t=>Object.assign(Object.assign({},t),{[a]:e}))}})),a).start()}static filter(t,e,a,n){let s=Threads.create({name:\"last states\"});return new PipeImpl(t,t=>{t.addReaction({name:\"save state\",dataConsumer:t=>s.reducers.$update(t)}),e.addReaction({name:\"pipe-filter\",dataConsumer:e=>{let n=s.getData();a(e,n)&&t.reducers.$update(e)}})},n).start()}}class ConanState{constructor(t){this.state=t}getName(){return this.state.getName()}connectMap(t,e){return React.createElement(StateMapConnect,{from:this,into:t,mapper:e})}connectData(t){return React.createElement(StateMapConnect,{from:this,into:t,mapper:t=>t})}connect(t){return React.createElement(StateConnect,{from:this,into:t})}connectLive(t,e){return React.createElement(StateLive,{from:this,renderer:t,fallbackValue:e})}addAsyncReaction(t){if(!this.isThreadBased())return this.asMonitor().addAsyncReaction(t)}addDataReaction(t){return this.state.addReaction(t)}get do(){return this.state.do}start(){return this.state.start(),this}stop(t){return this.state.stop(t),this}get actions(){return this.state.actions}getData(){return this.state.getData()}asyncMerge(t,e,a){if(this.isThreadBased())throw new Error(\"this conan state is not ready for async\");let n=Pipes.fromMonitor(this.state,e,a,{initialData:t});return new ConanState(new ThreadFacade(n,this.actions))}filter(t){let e=Pipes.filter(`filter=>${this.getName()}`,this.isThreadBased()?this.asThread():this.asMonitor().mainThread,t);return new ConanState(e)}map(t){let e=Pipes.map(`map=>${this.getName()}`,this.isThreadBased()?this.asThread():this.asMonitor().mainThread,t);return new ConanState(e)}merge(t,e){let a=Pipes.merge(`merge=>${this.getName()}`,this.isThreadBased()?this.asThread():this.asMonitor().mainThread,e,t.asThread(),(t,a,n)=>e(a,t,n));return new ConanState(a)}tuple(t){let e=Pipes.tupleCombine(`mergeTuple=>${this.getName()}`,this.isThreadBased()?this.asThread():this.asMonitor().mainThread,t.asThread());return new ConanState(e)}isThreadBased(){return!this.isMonitorBased()}isMonitorBased(){return this.state instanceof MonitorFacade}asThread(){return this.isThreadBased()?this.state:this.asMonitor().mainThread}asMonitor(){return this.state}static combine(t,e,a){let n=Pipes.combine(t,Objects.mapKeys(e,t=>t.asThread()),a);return new ConanState(n)}}class MonitorImpl{constructor(t,e){this.mainThread=t,this.asyncThread=e}start(){return this.mainThread.start(),this}addReaction(t){return this.mainThread.addReaction(t)}addAsyncReaction(t){return this.asyncThread.addReaction(t)}get do(){return this.mainThread.do}getEvents(){return this.mainThread.getEvents()}getName(){return this.mainThread.getName()}stop(t){this.mainThread.stop(t)}getData(){return this.mainThread.getData()}next(t){this.mainThread.next(t)}}class Monitors{static create(t){let e=this.createAsyncThread(t),a=Threads.create(Object.assign(Object.assign({},t),{pipelineListener:t=>{t.runtimeEvent!==FlowRuntimeEventType.MONITOR||(t.timing===FlowRuntimeEventTiming.REQUEST_START?e.do.tick(t.payload):t.timing===FlowRuntimeEventTiming.REQUEST_END?e.do.unTick(t.payload,!1):t.timing===FlowRuntimeEventTiming.REQUEST_CANCEL&&e.do.unTick(t.payload,!0))}})),n=new MonitorImpl(a,e);return new MonitorFacade(n,a.actions)}static createAsyncThread(t){return Threads.create({name:`monitor[${t.name}]`,actions:t=>({tick(e){t.reducers.$update(t=>({status:exports.MonitorStatus.ASYNC_START,currentAction:e,inProgressActions:[...t.inProgressActions,e]}))},unTick(e,a){t.reducers.$update(t=>({status:a?exports.MonitorStatus.ASYNC_CANCELLED:exports.MonitorStatus.ASYNC_FULFILLED,currentAction:e,inProgressActions:t.inProgressActions.filter(t=>t!==e)})),0===t.getData().inProgressActions.length&&t.reducers.$update(t=>({inProgressActions:[],currentAction:void 0,status:exports.MonitorStatus.IDLE}))}}),initialData:{inProgressActions:[],status:exports.MonitorStatus.IDLE,currentAction:void 0}})}}class Conan{static light(t,e){return new ConanState(Monitors.create({name:t,initialData:e}))}static state(t){return new ConanState(Monitors.create(t))}}class Lists{static mergeCombine(t,e,a,n){let s=[],r=!1;return s=e.map(e=>{for(let s of t)if(a(s,e))return r=!0,n(s,e);return e}),r?s:e}}exports.AsapParser=AsapParser,exports.Asaps=Asaps,exports.Conan=Conan,exports.ConanState=ConanState,exports.ContextStateConnect=ContextStateConnect,exports.ContextStateLive=ContextStateLive,exports.ContextStateMapConnect=ContextStateMapConnect,exports.DiAnnotationsMetadataFactory=DiAnnotationsMetadataFactory,exports.DiContextFactory=DiContextFactory,exports.DynamicOrStatics=DynamicOrStatics,exports.Flows=Flows,exports.InjectByName=InjectByName,exports.InjectByType=InjectByType,exports.InjectDynamic=InjectDynamic,exports.Lists=Lists,exports.ReactStateContext=ReactStateContext,exports.StateConnect=StateConnect,exports.StateLive=StateLive,exports.StateMapConnect=StateMapConnect,exports.contextStateConnect=contextStateConnect,exports.contextStateLive=contextStateLive,exports.contextStateMapConnect=contextStateMapConnect,exports.diAnnotationsCrud=diAnnotationsCrud,exports.isAsap=isAsap,exports.stateConnect=stateConnect,exports.stateLive=stateLive,exports.stateMapConnect=stateMapConnect,exports.useConanState=useConanState,exports.useContextConanState=useContextConanState,exports.useFlow=useFlow,exports.useFlowStatus=useFlowStatus;"]},"metadata":{},"sourceType":"script"}