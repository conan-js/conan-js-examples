(this["webpackJsonpconan-issues-viewer"]=this["webpackJsonpconan-issues-viewer"]||[]).push([[0],{59:function(e,t,n){e.exports=n(87)},64:function(e,t,n){},87:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(7),c=n.n(s),o=(n(64),n(12)),i=n(18),u=n(116),m=n(120),l=n(127),p=n(122),f=function(e){var t=e.org,n=e.repo,r=e.page,s=e.setOrgAndRepo,c=e.setJumpToPage,o=Object(a.useState)(t),f=Object(i.a)(o,2),E=f[0],h=f[1],d=Object(a.useState)(n),g=Object(i.a)(d,2),v=g[0],b=g[1],y=Object(a.useState)(""+r),x=Object(i.a)(y,2),C=x[0],j=x[1];return a.createElement("form",null,a.createElement(u.a,{item:!0,container:!0,xs:12,direction:"row"},a.createElement(u.a,{item:!0,xs:1},a.createElement(m.a,{variant:"h6"},"Org:")),a.createElement(u.a,{item:!0,xs:11,sm:2},a.createElement(l.a,{name:"org",size:"small",variant:"outlined",onChange:function(e){h(e.target.value)},value:E})),a.createElement(u.a,{item:!0,xs:1},a.createElement(m.a,{variant:"h6"},"Repo:")),a.createElement(u.a,{item:!0,xs:5,sm:2},a.createElement(l.a,{name:"repo",size:"small",variant:"outlined",onChange:function(e){b(e.target.value)},value:v})),a.createElement(u.a,{item:!0,xs:6},a.createElement(p.a,{variant:"outlined",style:{marginLeft:5},onClick:function(){s(E,v)}},"Load Repo"))),a.createElement(u.a,{item:!0,container:!0,xs:12,direction:"row"},a.createElement(u.a,{item:!0,xs:1},a.createElement(m.a,{variant:"h6"},"Page:")),a.createElement(u.a,{item:!0,xs:5,sm:2},a.createElement(l.a,{name:"jumpToPage",size:"small",variant:"outlined",onChange:function(e){j(e.target.value)},value:C})),a.createElement(u.a,{item:!0,xs:6},a.createElement(p.a,{variant:"outlined",style:{marginLeft:5},onClick:function(){var e=parseInt(C);e>=1&&c(e)}},"Jump to Page"))))},E=function(e){var t=e.labels;e.className;return a.createElement(a.Fragment,null,t.map((function(e){return a.createElement("span",{key:e.id,className:"issue__label",style:{boxShadow:"0 0 2px #".concat(e.color),borderColor:"#".concat(e.color)}},e.name)})))},h=n(128),d=n(123);var g=function(e){var t=e.number,n=e.title,r=e.labels,s=e.user,c=e.comments,o=e.body,i=void 0===o?"":o,l=e.showIssueComments,p=1===c?"comment":"comments";return a.createElement(u.a,{item:!0,container:!0,direction:"row",justify:"space-around"},a.createElement(u.a,{item:!0,xs:3},a.createElement(h.a,{src:s.avatar_url}),a.createElement(m.a,{color:"textSecondary"},s.login)),a.createElement(u.a,{item:!0,xs:9},a.createElement("a",{href:"#comments",onClick:function(e){e.preventDefault(),e.stopPropagation(),l(t)}},a.createElement(m.a,{color:"primary"},a.createElement("span",null,"#",t)),a.createElement(m.a,{color:"secondary"},a.createElement("span",null," ",n))),a.createElement(m.a,{color:"secondary"},"(",c," ",p,")"),a.createElement(m.a,{color:"primary"},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:140,n=e.replace(/\\r\\n/g,"\n");if(n.length<=t)return n;var a=" ...",r=n.substr(0,141);if(/\W$/.test(r))return r.substr(0,140)+a;for(var s=r.length;--s;)if(/\W/.test(r[s]))return r.substr(0,s)+a;return r.substr(0,140)+a}(i)),a.createElement(E,{labels:r}),a.createElement(d.a,null)))},v=n(124),b=n(121),y=function(e){var t=e.data,n=e.actions;if(null!=t.issues&&null!=t.issues.map){var r=t.issues.map((function(e){return a.createElement(v.a,{key:e.id},a.createElement(g,Object.assign({},e,{showIssueComments:n.fetchIssue})))}));return a.createElement(b.a,null,r)}return a.createElement(a.Fragment,null)},x=n(10),C=x.Conan.state({name:"issues",initialData:{issuesByNumber:{},issues:[],displayType:"issues"},reducers:function(e){return{$fetch:function(t){return t.forEach((function(t){e().issuesByNumber[t.number]=t})),Object(o.a)(Object(o.a)({},e()),{},{issues:t,displayType:"issues"})},$fetchIssue:function(t){return Object(o.a)(Object(o.a)({},e()),{},{issueId:t,displayType:"comments"})},$switchDisplay:function(t){return Object(o.a)(Object(o.a)({},e()),{},{displayType:t})}}},actions:function(e){return{fetch:function(t,n,a){return e.monitor(w.issuesService.fetch(t,n,a).catch((function(){return e.reducers.$fetch([])})),(function(e,t){return t.$fetch(e)}),"fetch",[t,n,a])},fetchIssue:function(t){return e.reducers.$fetchIssue(t)},showIssues:function(){return e.reducers.$switchDisplay("issues")}}}}),j=n(50),O=n(51),I=function(){function e(){Object(j.a)(this,e)}return Object(O.a)(e,[{key:"fetch",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return x.Asaps.fetch("https://api.github.com/repos/".concat(t,"/").concat(e,"/issues?per_page=25&page=").concat(n))}},{key:"fetchComments",value:function(e){return x.Asaps.fetch(e)}},{key:"fetchRepoDetails",value:function(e,t){return x.Asaps.fetch("https://api.github.com/repos/".concat(e,"/").concat(t))}}]),e}(),S=x.Conan.state({name:"issues-comments",initialData:{commentsByIssue:{}},reducers:function(e){return{$fetchComments:function(t,n){return e().commentsByIssue[t]=n,Object(o.a)({},e())}}},actions:function(e){return{fetchComments:function(t){return e.monitor(w.issuesService.fetchComments(t.comments_url).catch((function(){return e.reducers.$fetch([])})),(function(e,n){return n.$fetchComments(t.id,e)}),"fetchComments",t.comments_url)}}}}),D=x.Conan.light("repo",{org:"rails",repo:"rails",page:1}),_=x.Conan.state({name:"repo-details",initialData:{openIssuesCount:-1,error:null},reducers:function(){return{$fetchRepoDetails:function(e,t){return{error:t,openIssuesCount:e}}}},actions:function(e){return{fetchRepoDetails:function(t,n){return e.monitor(w.issuesService.fetchRepoDetails(t,n).catch((function(){return e.reducers.$fetchRepoDetails(-1,"error loading")})),(function(e,t){return t.$fetchRepoDetails(e.open_issues_count,"")}),"fetchRepoDetails",[t,n])}}}}),w=x.DiContextFactory.createContext({issuesCommentsState:S,issuesState:C,repoState:D,repoDetailsState:_},{issuesService:I});function $(e){var t=e.org,n=e.repo;return a.createElement("span",null,a.createElement("a",{href:"https://github.com/".concat(t),className:"header__org"},t)," / ",a.createElement("a",{href:"https://github.com/".concat(t,"/").concat(n),className:"header__repo"},n))}function R(e){var t=e.openIssuesCount,n=void 0===t?-1:t,r=e.org,s=e.repo;if(-1===n)return a.createElement(a.Fragment,null,a.createElement(m.a,{variant:"h4"}," issues for "),a.createElement($,{org:r,repo:s}));var c=1===n?"issue":"issues";return a.createElement(a.Fragment,null,a.createElement(m.a,{variant:"h4"},a.createElement("span",{className:"header__openIssues"},n)," open"," ",c," for ",a.createElement($,{org:r,repo:s})))}var k=function(e){var t=e.org,n=e.repo,r=e.page,s=void 0===r?1:r,c=e.fetchIssues,o=e.fetchRepoDetails;return Object(a.useEffect)((function(){c(t,n,s),o(t,n)}),[t,n,s]),a.createElement("div",{id:"issue-list-page"},_.connectMap(R,(function(e){return{org:t,repo:n,openIssuesCount:e.openIssuesCount}})),w.issuesState.connect(y))},N=function(e){var t=e.issue.state;return a.createElement(m.a,{variant:"h6",color:"secondary"},t)},B=function(e){var t=e.issue;return a.createElement(m.a,{variant:"h6",color:"secondary"},"#",t.number)},T=function(e){var t=e.issue;return a.createElement(u.a,{container:!0,spacing:2},a.createElement(u.a,{item:!0,xs:2},a.createElement(B,{issue:t})),a.createElement(u.a,{item:!0,xs:2},a.createElement(N,{issue:t})),a.createElement(u.a,{item:!0,xs:2},a.createElement(h.a,{src:t.user.avatar_url}),a.createElement(m.a,{color:"textSecondary"},t.user.login)))};function A(e){var t=e.comment;return a.createElement(u.a,{item:!0,container:!0,direction:"column",spacing:1,justify:"space-around"},a.createElement(u.a,{item:!0,container:!0,xs:4,spacing:1},a.createElement(u.a,{item:!0,xs:1},a.createElement(h.a,{src:t.user.avatar_url})),a.createElement(u.a,{item:!0,xs:1},a.createElement(m.a,{color:"textSecondary"},t.user.login))),a.createElement(u.a,{item:!0,xs:12}),a.createElement(u.a,{item:!0,xs:10},a.createElement(m.a,{color:"textPrimary"},t.body)),a.createElement(u.a,{item:!0,xs:12},a.createElement(d.a,{light:!0})))}function L(e){var t=e.comments,n=void 0===t?[]:t;return 0===e.issue.comments?a.createElement("div",{className:"issue-detail--no-comments"},"No comments"):n&&0!==n.length?a.createElement(b.a,null,n.map((function(e){return a.createElement(v.a,{key:e.id},a.createElement(A,{comment:e}))}))):a.createElement("div",{className:"issue-detail--comments-loading"},"Comments loading...")}var P=n(35),z=function(e){var t=e.text,n=new P.a;return a.createElement("div",{dangerouslySetInnerHTML:{__html:n.render(t)}})},F=function(e){var t=e.issue,n=e.showIssuesList,r=e.fetchComments,s=Object(x.useConanState)(S),c=Object(i.a)(s,1)[0];Object(a.useEffect)((function(){t&&r(t)}),[]);var o,l=a.createElement(p.a,{onClick:n,variant:"outlined",color:"secondary"},"Back to Issues List"),f=(new P.a,c.commentsByIssue[t.id]);f&&(o=a.createElement(L,{issue:t,comments:f}));var h,g=a.createElement(u.a,{container:!0,spacing:2},a.createElement(u.a,{item:!0,xs:12},a.createElement(m.a,{variant:"h3",color:"primary"},t.title)),a.createElement(u.a,{item:!0,xs:12},l),a.createElement(u.a,{item:!0,xs:12},a.createElement(T,{issue:t})),a.createElement(u.a,{item:!0,xs:12},a.createElement(E,{labels:t.labels})),a.createElement(u.a,{item:!0,container:!0,xs:12,spacing:1},a.createElement(u.a,{item:!0,xs:1}),a.createElement(u.a,{item:!0,xs:11},a.createElement(m.a,{variant:"body1",color:"primary"},a.createElement(z,{text:(h=t.body,h.replace(/\B(@([a-zA-Z0-9](-?[a-zA-Z0-9_])+))/g,"**[$1](https://github.com/$2)**"))})))),a.createElement(u.a,{item:!0,container:!0,xs:12,spacing:1},a.createElement(u.a,{item:!0,xs:1}),a.createElement(u.a,{item:!0,xs:10},a.createElement(d.a,{light:!0})),a.createElement(u.a,{item:!0,xs:1})),a.createElement(u.a,{item:!0,container:!0,xs:12,spacing:1},a.createElement(u.a,{item:!0,xs:2}),a.createElement(u.a,{item:!0,xs:10},o)));return a.createElement("div",null,g)},J=n(126),M=n(52),W=n(125),Z=Object(M.a)({palette:{primary:{main:W.a[800]},secondary:{main:W.a[500]}}}),H=function(){return w.issuesState.connectData(q)},q=function(e){var t,n=e.displayType,r=e.issuesByNumber,s=e.issueId,c=e.issues,m=Object(x.useConanState)(D),l=Object(i.a)(m,1)[0];return t="issues"===n?a.createElement(u.a,{container:!0,spacing:1,direction:"column"},a.createElement(u.a,{item:!0,xs:12,lg:4},a.createElement(f,{org:l.org,repo:l.repo,page:l.page,setOrgAndRepo:function(e,t){w.repoState.do.update((function(n){return Object(o.a)(Object(o.a)({},n),{},{org:e,repo:t})}))},setJumpToPage:function(e){w.repoState.do.update((function(t){return Object(o.a)(Object(o.a)({},t),{},{page:e})}))}})),a.createElement(u.a,{item:!0,xs:12,lg:4},a.createElement(k,{org:l.org,repo:l.repo,page:l.page,fetchIssues:w.issuesState.do.fetch,fetchRepoDetails:w.repoDetailsState.do.fetchRepoDetails,issues:c}))):a.createElement(F,{issue:r[s],org:l.org,repo:l.repo,showIssuesList:w.issuesState.do.showIssues,fetchComments:w.issuesCommentsState.do.fetchComments}),a.createElement("div",{className:"App"},a.createElement(J.a,{theme:Z},t))};c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(H,null)),document.getElementById("root"))}},[[59,1,2]]]);
//# sourceMappingURL=main.c7973b25.chunk.js.map